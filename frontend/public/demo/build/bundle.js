var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function s(){return Object.create(null)}function i(t){t.forEach(n)}function o(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}function c(t,e,n){t.$$.on_destroy.push(a(e,n))}function l(t,e,n,s){return t[1]&&s?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](s(e))):n.ctx}function u(t,e,n,s,i,o,r){const a=function(t,e,n,s){if(t[2]&&s){const i=t[2](s(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let s=0;s<n;s+=1)t[s]=e.dirty[s]|i[s];return t}return e.dirty|i}return e.dirty}(e,s,i,o);if(a){const i=l(e,n,s,r);t.p(i,a)}}const h="undefined"!=typeof window;let d=h?()=>window.performance.now():()=>Date.now(),p=h?t=>requestAnimationFrame(t):t;const f=new Set;function m(t){f.forEach((e=>{e.c(t)||(f.delete(e),e.f())})),0!==f.size&&p(m)}let g,_=!1;function v(t,e,n,s){for(;t<e;){const i=t+(e-t>>1);n(i)<=s?t=i+1:e=i}return t}function y(t,e){_?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),s=new Int32Array(e.length);n[0]=-1;let i=0;for(let t=0;t<e.length;t++){const o=v(1,i+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;s[t]=n[o]+1;const r=o+1;n[r]=t,i=Math.max(r,i)}const o=[],r=[];let a=e.length-1;for(let t=n[i]+1;0!=t;t=s[t-1]){for(o.push(e[t-1]);a>=t;a--)r.push(e[a]);a--}for(;a>=0;a--)r.push(e[a]);o.reverse(),r.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<r.length;e++){for(;n<o.length&&r[e].claim_order>=o[n].claim_order;)n++;const s=n<o.length?o[n]:null;t.insertBefore(r[e],s)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function w(t,e,n){_&&!n?y(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function x(t){t.parentNode.removeChild(t)}function b(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function T(t){return document.createElement(t)}function C(t){return document.createTextNode(t)}function A(){return C(" ")}function S(){return C("")}function k(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function O(t){return function(e){return e.preventDefault(),t.call(this,e)}}function M(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function E(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function D(){if(void 0===g){g=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){g=!0}}return g}function I(t,e,n){t.classList[n?"add":"remove"](e)}const N=new Set;let R,P=0;function V(t,e,n,s,i,o,r,a=0){const c=16.666/s;let l="{\n";for(let t=0;t<=1;t+=c){const s=e+(n-e)*o(t);l+=100*t+`%{${r(s,1-s)}}\n`}const u=l+`100% {${r(n,1-n)}}\n}`,h=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${a}`,d=t.ownerDocument;N.add(d);const p=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(T("style")).sheet),f=d.__svelte_rules||(d.__svelte_rules={});f[h]||(f[h]=!0,p.insertRule(`@keyframes ${h} ${u}`,p.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${h} ${s}ms linear ${i}ms 1 both`,P+=1,h}function $(t,e){const n=(t.style.animation||"").split(", "),s=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-s.length;i&&(t.style.animation=s.join(", "),P-=i,P||p((()=>{P||(N.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),N.clear())})))}function q(t){R=t}function F(){if(!R)throw new Error("Function called outside component initialization");return R}function j(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const L=[],W=[],B=[],U=[],z=Promise.resolve();let G=!1;function X(){G||(G=!0,z.then(K))}function Y(){return X(),z}function Z(t){B.push(t)}let H=!1;const Q=new Set;function K(){if(!H){H=!0;do{for(let t=0;t<L.length;t+=1){const e=L[t];q(e),J(e.$$)}for(q(null),L.length=0;W.length;)W.pop()();for(let t=0;t<B.length;t+=1){const e=B[t];Q.has(e)||(Q.add(e),e())}B.length=0}while(L.length);for(;U.length;)U.pop()();G=!1,H=!1,Q.clear()}}function J(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Z)}}let tt;function et(t,e,n){t.dispatchEvent(function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(`${e?"intro":"outro"}${n}`))}const nt=new Set;let st;function it(){st={r:0,c:[],p:st}}function ot(){st.r||i(st.c),st=st.p}function rt(t,e){t&&t.i&&(nt.delete(t),t.i(e))}function at(t,e,n,s){if(t&&t.o){if(nt.has(t))return;nt.add(t),st.c.push((()=>{nt.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}const ct={duration:0};function lt(n,s,r,a){let c=s(n,r),l=a?0:1,u=null,h=null,g=null;function _(){g&&$(n,g)}function v(t,e){const n=t.b-l;return e*=Math.abs(n),{a:l,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function y(s){const{delay:o=0,duration:r=300,easing:a=e,tick:y=t,css:w}=c||ct,x={start:d()+o,b:s};s||(x.group=st,st.r+=1),u||h?h=x:(w&&(_(),g=V(n,l,s,r,o,a,w)),s&&y(0,1),u=v(x,r),Z((()=>et(n,s,"start"))),function(t){let e;0===f.size&&p(m),new Promise((n=>{f.add(e={c:t,f:n})}))}((t=>{if(h&&t>h.start&&(u=v(h,r),h=null,et(n,u.b,"start"),w&&(_(),g=V(n,l,u.b,u.duration,0,a,c.css))),u)if(t>=u.end)y(l=u.b,1-l),et(n,u.b,"end"),h||(u.b?_():--u.group.r||i(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;l=u.a+u.d*a(e/u.duration),y(l,1-l)}return!(!u&&!h)})))}return{run(t){o(c)?(tt||(tt=Promise.resolve(),tt.then((()=>{tt=null}))),tt).then((()=>{c=c(),y(t)})):y(t)},end(){_(),u=h=null}}}function ut(t,e){const n=e.token={};function s(t,s,i,o){if(e.token!==n)return;e.resolved=o;let r=e.ctx;void 0!==i&&(r=r.slice(),r[i]=o);const a=t&&(e.current=t)(r);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==s&&t&&(it(),at(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),ot())})):e.block.d(1),a.c(),rt(a,1),a.m(e.mount(),e.anchor),c=!0),e.block=a,e.blocks&&(e.blocks[s]=a),c&&K()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=F();if(t.then((t=>{q(n),s(e.then,1,e.value,t),q(null)}),(t=>{if(q(n),s(e.catch,2,e.error,t),q(null),!e.hasCatch)throw t})),e.current!==e.pending)return s(e.pending,0),!0}else{if(e.current!==e.then)return s(e.then,1,e.value,t),!0;e.resolved=t}var i}const ht="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function dt(t,e){at(t,1,1,(()=>{e.delete(t.key)}))}function pt(t){t&&t.c()}function ft(t,e,s,r){const{fragment:a,on_mount:c,on_destroy:l,after_update:u}=t.$$;a&&a.m(e,s),r||Z((()=>{const e=c.map(n).filter(o);l?l.push(...e):i(e),t.$$.on_mount=[]})),u.forEach(Z)}function mt(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function gt(e,n,o,r,a,c,l=[-1]){const u=R;q(e);const h=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:n.context||[]),callbacks:s(),dirty:l,skip_bound:!1};let d=!1;if(h.ctx=o?o(e,n.props||{},((t,n,...s)=>{const i=s.length?s[0]:n;return h.ctx&&a(h.ctx[t],h.ctx[t]=i)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](i),d&&function(t,e){-1===t.$$.dirty[0]&&(L.push(t),X(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],h.update(),d=!0,i(h.before_update),h.fragment=!!r&&r(h.ctx),n.target){if(n.hydrate){_=!0;const t=function(t){return Array.from(t.childNodes)}(n.target);h.fragment&&h.fragment.l(t),t.forEach(x)}else h.fragment&&h.fragment.c();n.intro&&rt(e.$$.fragment),ft(e,n.target,n.anchor,n.customElement),_=!1,K()}q(u)}class _t{$destroy(){mt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const vt=[];function yt(e,n=t){let s;const i=[];function o(t){if(r(e,t)&&(e=t,s)){const t=!vt.length;for(let t=0;t<i.length;t+=1){const n=i[t];n[1](),vt.push(n,e)}if(t){for(let t=0;t<vt.length;t+=2)vt[t][0](vt[t+1]);vt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(r,a=t){const c=[r,a];return i.push(c),1===i.length&&(s=n(o)||t),r(e),()=>{const t=i.indexOf(c);-1!==t&&i.splice(t,1),0===i.length&&(s(),s=null)}}}}function wt(e,n,s){const r=!Array.isArray(e),c=r?[e]:e,l=n.length<2;return function(t,e){return{subscribe:yt(t,e).subscribe}}(s,(e=>{let s=!1;const u=[];let h=0,d=t;const p=()=>{if(h)return;d();const s=n(r?u[0]:u,e);l?e(s):d=o(s)?s:t},f=c.map(((t,e)=>a(t,(t=>{u[e]=t,h&=~(1<<e),s&&p()}),(()=>{h|=1<<e}))));return s=!0,p(),function(){i(f),d()}}))}function xt(t,e,n=((t,e)=>t!==e)){let s=e;return wt(t,((t,e)=>{n(t,s)&&(s=t,e(t))}),s)}function bt(t){return wt(t,((t,e)=>{if(void 0!==t)return t.subscribe(e);e(void 0)}))}function Tt(t){const e={},n={};return wt(t,((t,s)=>{const i=Object.keys(t),o=Object.keys(n),r=i.filter((t=>void 0===n[t])),a=o.filter((e=>void 0===t[e]));r.forEach((i=>{const o=t[i];let r=!0;const a=o.subscribe((t=>{n[i]=t,r?r=!1:s(n)}));e[i]=a})),a.forEach((t=>{const s=e[t];void 0!==s&&s(),delete e[t],delete n[t]})),s(n)}),{})}const Ct=Object.freeze({NONE:0,DIAGONAL:1,LEFT:2,TOP:3});var At={TracedScore:(t,e=Ct.NONE)=>{if(Object.values(Ct).includes(e))return{score:t,direction:e};throw TypeError("Invalid direction value for TracedScore")},directions:Ct};const{TracedScore:St}=At,kt=(t,e)=>{if(Number.isInteger(e.score))return e.score>t.score?e:t;throw TypeError(`Score object as an invalid score property: ${e.score}.`)};var Ot={reverse:((...t)=>t.reduce(((t,e)=>n=>e(t(n))),(t=>t)))((t=>Number.isNaN(Number(t))?(()=>{throw TypeError("Non number input to decreaseAndRectify().")})():t),(t=>-t)),reduceTracedScores:(t,e)=>t.reduce(kt,St(e))};const{directions:Mt}=At;var Et={createMatrix:({width:t,heigth:e,fill:n=0})=>Array(e).fill(n).map((()=>Array(t).fill(n))),extractColumn:({matrix:t,row:e,col:n})=>t.slice(0,e+1).map((t=>t.slice(n,n+1))).reduce(((t,e)=>[...t,...e]),[]),extractRow:({matrix:t,row:e,col:n})=>t[e].slice(0,n+1),initNWScoringMatrix:({width:t,heigth:e})=>{const n=[];for(let s=0;s<e;s+=1)0===s?n[s]=Array(t).fill().map(((t,e)=>-e||0)):(n[s]=Array(t).fill(0),n[s][0]=-s);return n},initNWTracebacMatrix:({width:t,heigth:e})=>{const n=[];for(let s=0;s<e;s+=1)0===s?n[s]=Array(t).fill(Mt.LEFT):(n[s]=Array(t).fill(Mt.NONE),n[s][0]=Mt.TOP),n[0][0]=Mt.NONE;return n}};const{initNWScoringMatrix:Dt,initNWTracebacMatrix:It}=Et,{reduceTracedScores:Nt}=Ot,{TracedScore:Rt,directions:Pt}=At;var Vt=function({sequence1:t,sequence2:e,gapScoreFunction:n,similarityScoreFunction:s}){const i=t.length+1,o=e.length+1,r=Dt({width:o,heigth:i}),a=It({width:o,heigth:i});let c=0,l=[0,0];for(let u=1;u<i;u+=1)for(let i=1;i<o;i+=1){const o=s(t[u-1],e[i-1]),h=[Rt(r[u-1][i]+n(),Pt.TOP),Rt(r[u][i-1]+n(),Pt.LEFT),Rt(r[u-1][i-1]+o,Pt.DIAGONAL)],{score:d,direction:p}=Nt(h,-1/0);r[u][i]=d,a[u][i]=p,c=d,l=[u,i]}return{alignmentScore:c,scoringMatrix:r,tracebackMatrix:a,tracebackStart:l}};const{createMatrix:$t,extractColumn:qt,extractRow:Ft}=Et,{reduceTracedScores:jt}=Ot,{TracedScore:Lt,directions:Wt}=At;function Bt(t){let e=-1,n=0;for(let s=1;s<t.length;s+=1)t[s]>e&&(e=t[s],n=s);return{max:e,gapLength:n}}function Ut({scoringMatrix:t,row:e,col:n,gapScoreFunction:s,similarityScore:i}){const o=Ft({matrix:t,row:e,col:n}),r=qt({matrix:t,row:e,col:n}),{max:a,gapLength:c}=Bt(o.reverse()),{max:l,gapLength:u}=Bt(r.reverse());return[Lt(l+s(u),Wt.TOP),Lt(a+s(c),Wt.LEFT),Lt(t[e-1][n-1]+i,Wt.DIAGONAL)]}var zt=function({sequence1:t,sequence2:e,gapScoreFunction:n,similarityScoreFunction:s}){const i=t.length+1,o=e.length+1,r=$t({width:o,heigth:i}),a=$t({width:o,heigth:i,fill:Wt.NONE});let c=0,l=[0,0];for(let u=1;u<i;u+=1)for(let i=1;i<o;i+=1){const o=Ut({scoringMatrix:r,row:u,col:i,gapScoreFunction:n,similarityScore:s(t[u-1],e[i-1])}),{score:h,direction:d}=jt(o,0);r[u][i]=h,a[u][i]=d,h>=c&&(c=h,l=[u,i])}return{alignmentScore:c,scoringMatrix:r,tracebackMatrix:a,tracebackStart:l}};const{directions:Gt}=At;var Xt={alignmentUpdaters:t=>e=>({[Gt.DIAGONAL]:({seq1:t,seq2:e,row:n,col:s})=>[t[n-1],e[s-1]],[Gt.LEFT]:({seq2:e,col:n})=>[t,e[n-1]],[Gt.TOP]:({seq1:e,row:n})=>[e[n-1],t]}[e]),coordinateUpdaters:t=>({[Gt.DIAGONAL]:([t,e])=>[t-1,e-1],[Gt.LEFT]:([t,e])=>[t,e-1],[Gt.TOP]:([t,e])=>[t-1,e]}[t])};const{alignmentUpdaters:Yt,coordinateUpdaters:Zt}=Xt,{directions:Ht}=At;var Qt=function({sequence1:t,sequence2:e,tracebackMatrix:n,tracebackStart:s,gapSymbol:i}){let[o,r]=s;const a=[],c=[],l=[[o,r]],u=Yt(i);for(;n[o][r]!==Ht.NONE;){const s=n[o][r],i=u(s),[h,d]=i({seq1:t,seq2:e,row:o,col:r});a.unshift(h),c.unshift(d);const p=Zt(s);[o,r]=p([o,r]),l.push([o,r])}return{alignedSequence1:a.join(""),alignedSequence2:c.join(""),coordinateWalk:l}};const{directions:Kt}=At;var Jt=({algorithm:t,similarityScoreFunctionDefault:e,gapScoreFunctionDefault:n,gapSymbolDefault:s})=>({similarityScoreFunction:i=e,gapScoreFunction:o=n,gapSymbol:r=s}={})=>({similarityScoreFunction:i,gapScoreFunction:o,gapSymbol:r,directions:Kt,align(e="",n=""){const{alignmentScore:s,scoringMatrix:i,tracebackMatrix:o,tracebackStart:r}=t({sequence1:e,sequence2:n,gapScoreFunction:this.gapScoreFunction,similarityScoreFunction:this.similarityScoreFunction}),{alignedSequence1:a,alignedSequence2:c,coordinateWalk:l}=Qt({sequence1:e,sequence2:n,tracebackMatrix:o,tracebackStart:r,gapSymbol:this.gapSymbol});return{score:s,originalSequences:[e,n],alignedSequences:[a,c],coordinateWalk:l,scoringMatrix:i,tracebackMatrix:o,alignment:`${a}\n${c}`}}});const{reverse:te}=Ot;const ee={NWaligner:Jt({algorithm:Vt,similarityScoreFunctionDefault:(t,e)=>t===e?1:-2,gapScoreFunctionDefault:()=>-1,gapSymbolDefault:"-"}),SWaligner:Jt({algorithm:zt,similarityScoreFunctionDefault:(t,e)=>t===e?2:-1,gapScoreFunctionDefault:te,gapSymbolDefault:"-"})}.NWaligner({similarityScoreFunction:(t,e)=>t.toLowerCase()===e.toLowerCase()?1:-2});function ne(t,e){const n=e.map((e=>function(t,e){if(!t)return{text:e,score:0};const n=ee.align(t,e),s=n.alignedSequences[0];let i=0;for(let t=s.length;t--&&"-"===s[t];t>=0)i++;const o=e.substring(e.length-i,e.length);return{text:t+o,score:n.score}}(t,e)));n.sort(((t,e)=>e.score-t.score));const s=n.map((t=>t.text)),i=0===t.length?[]:[t];return s.filter((t=>!i.includes(t)&&(i.push(t),!0))),i}function se(t,e,n){return Math.min(Math.max(t,e),n)}function ie(t,e){const n=Object.keys(t).map((t=>parseInt(t)));let s=se(e,Math.min(...n),Math.max(...n));for(;!(s in t);)s++;return t[s]}function oe(t,e){const n=t[e];if(void 0===n)throw new Error(`Idx ${e} did not exist in list ${t}, asserted that it did`);return n}const re=yt([]),ae=yt({}),ce=wt([ae,re],(([t,e])=>{const n=Object.keys(t).map((t=>parseInt(t)));n.sort(((t,e)=>t-e)),n.unshift(-1);const s=e.length-1;n[n.length-1]!==s&&n.push(s);const i=[];for(let t=1;t<n.length;t++){const e=oe(n,t-1)+1,s=oe(n,t);i.push({start:e,end:s})}return i}));function le(t){const e={},n=[];let s=!1,i=0;return t.forEach(((t,o)=>{var r;s&&t.startTime-i>.3&&(null===(r=n[n.length-1])||void 0===r||r.update((t=>Object.assign(Object.assign({},t),{endParagraph:!0})))),s=function({options:t}){const e=t[0];if(void 0===e)return!1;const n=e[e.length-1];return void 0!==n&&ue.includes(n)}(t),i=t.endTime;const a=function(t,e){var n,s;const i=yt({idx:e,startTime:t.startTime,endTime:t.endTime,originalOptions:t.options,completionOptions:ne("",t.options),text:"",placeholder:null!==(s=null===(n=t.options)||void 0===n?void 0:n[0])&&void 0!==s?s:"",edited:!1,endParagraph:!1});return i.subscribe((({idx:t,endParagraph:e})=>ae.update((n=>(e?n[t]=!0:delete n[t],n))))),i}(t,o);n.push(a),e[o]={startTime:t.startTime,endTime:t.endTime}})),re.set(n),e}const ue=[".","!","?"];function he(t){if(void 0===t)return;const e=document.querySelector(`[data-sectionIdx="${t}"]`);return null!=e?e:void 0}const de=yt(void 0),pe=xt(de,void 0);function fe(t){return function(t){const e={subscribe:()=>()=>{},set:()=>{},update:()=>{}},{subscribe:n}=wt(t,((t,n)=>{if(void 0!==t)return e.set=t.set,e.update=t.update,t.subscribe(n);n(void 0)}));return e.subscribe=n,e}(wt([re,t],(([t,e])=>{if(void 0!==e)return function(t,e){if(0===t.length)return;return t[se(e,0,t.length-1)]}(t,e.section)})))}const me=wt(pe,(t=>null==t?void 0:t.anchor)),ge=wt(pe,(t=>null==t?void 0:t.focus)),_e=fe(me),ve=wt(_e,(t=>null==t?void 0:t.idx)),ye=fe(ge),we=wt(ye,(t=>null==t?void 0:t.idx)),xe=wt([pe,_e,ye],(([t,e,n])=>(null==t?void 0:t.inverted)?n:e)),be=wt(xe,(t=>null==t?void 0:t.idx)),Te=wt([pe,_e,ye],(([t,e,n])=>(null==t?void 0:t.inverted)?e:n)),Ce=wt(Te,(t=>null==t?void 0:t.idx)),Ae=wt(pe,(t=>void 0!==t&&(t.anchor.section!==t.focus.section||t.anchor.offset!==t.focus.offset))),Se=wt(pe,(t=>void 0!==t&&t.anchor.section!==t.focus.section));async function ke(){return new Promise((t=>{setTimeout((async()=>{await async function(){const t=window.getSelection();if(null===t)return;const e=Oe(t.anchorNode,t.anchorOffset,"anchor"),n=Oe(t.focusNode,t.focusOffset,"focus");if(void 0===e)return;if(void 0===n)return;const s=function(t,e){return e.section<t.section||!(e.section>t.section)&&e.offset<t.offset}(e,n),i=s?n:e,o=s?e:n;de.set({anchor:e,focus:n,early:i,late:o,inverted:s}),await Y()}(),t()}))}))}function Oe(t,e,n){var s,i,o,r,a,c,l,u,h;let d,p,f=!1;if(null===(i=null===(s=null==t?void 0:t.parentElement)||void 0===s?void 0:s.classList)||void 0===i?void 0:i.contains("section")){d=t.parentElement;const n=se(e,1,(null!==(r=null===(o=d.textContent)||void 0===o?void 0:o.length)&&void 0!==r?r:1)-1);p=n-1,n!==e&&(f=!0)}else{if(!(null===(c=null===(a=null==t?void 0:t.parentElement)||void 0===a?void 0:a.classList)||void 0===c?void 0:c.contains("paragraph")))throw console.log("Unrecognised selection position",{node:t,offset:e,side:n}),new Error("Unrecognised selection position");{const e=t.nextElementSibling;d=null===e?null===(l=t.parentElement.nextElementSibling)||void 0===l?void 0:l.firstElementChild:e,p=0,f=!0}}if(null===d.parentElement)return;if(f){const t=d.firstChild,e=window.getSelection();null!==t&&null!==e&&("anchor"===n?e.setBaseAndExtent(t,p+1,null!==(u=e.focusNode)&&void 0!==u?u:t,e.focusOffset):e.setBaseAndExtent(null!==(h=e.anchorNode)&&void 0!==h?h:t,e.anchorOffset,t,p+1))}const m=d.getAttribute("data-sectionIdx");if(null===m)throw new Error("Null sectionIdx");return{section:parseInt(m),offset:p}}wt([ye,pe],(([t,e])=>{var n,s,i;if(void 0===t||void 0===e)return{start:!1,end:!1};const o=0===e.focus.offset,r=null!==(i=null===(s=null===(n=he(t.idx))||void 0===n?void 0:n.textContent)||void 0===s?void 0:s.length)&&void 0!==i?i:0;return{start:o,end:e.focus.offset>=r-2}})),wt([be,Ce,re],(([t,e,n])=>{if(void 0===t)return[];if(void 0===e)return[];const s=[];for(let i=t;i<=e;i++){const t=oe(n,i);s.push(t)}return s}));const Me=yt(5),Ee=yt("context"),De={sectionOffset:-3,constrainWithinParagraph:!0,addGap:!0,timeOffset:0},Ie={sectionOffset:3,constrainWithinParagraph:!0,addGap:!0,timeOffset:0},Ne={start:{sectionOffset:Number.MIN_SAFE_INTEGER,constrainWithinParagraph:!0,addGap:!0,timeOffset:0},end:{sectionOffset:Number.MAX_SAFE_INTEGER,constrainWithinParagraph:!0,addGap:!0,timeOffset:0}},Re={start:{sectionOffset:0,constrainWithinParagraph:!1,addGap:!1,timeOffset:0},end:{sectionOffset:Number.MAX_SAFE_INTEGER,constrainWithinParagraph:!1,addGap:!0,timeOffset:0}},Pe=wt([Ee,Me],(([t,e])=>{switch(t){case"context":return{start:Object.assign(Object.assign({},De),{sectionOffset:-e}),end:Object.assign(Object.assign({},Ie),{sectionOffset:e})};case"paragraph":return Ne;case"onward":return Re}}));function Ve(t){const e="start"===t?-1:1,n=bt(wt([Se,"early"===("start"===t?"early":"late")?be:Ce,pe,Pe,re,ce],(([e,n,s,i,o,r])=>{if(void 0===n)return;if(void 0===s)return;if(e)return o[n];const a=n+i[t].sectionOffset;if(i[t].constrainWithinParagraph){const t=r.find((t=>t.start<=n&&t.end>=n));if(!t)throw new Error(`Couldn't find paragraph for section idx ${n}`);return ie(o,se(a,t.start,t.end))}return ie(o,a)}))),s=bt(wt([n,Pe,re],(([t,n,s])=>{if(void 0===t)return;return ie(s,t.idx+e)})));let i;i=wt([n,s,Pe],"start"===t?([t,e,n])=>{if(void 0!==t&&void 0!==e)return t.idx===e.idx&&n.start.addGap?t.startTime-2:n.start.addGap?(t.startTime+e.endTime)/2:t.startTime}:([t,e,n])=>{if(void 0!==t&&void 0!==e)return t.idx===e.idx&&n.end.addGap?t.endTime+2:n.end.addGap?(t.endTime+e.startTime)/2:t.endTime});const o=wt([i,Pe],(([e,n])=>{if(void 0!==e)return e+n[t].timeOffset}));return wt([n,o],(([t,e])=>{if(void 0!==t&&void 0!==e)return{time:e,sectionIdx:t.idx}}))}const $e=xt(wt([Ve("start"),Ve("end")],(([t,e])=>{if(void 0!==t&&void 0!==e)return{start:t,end:e}})),void 0,((t,e)=>{var n,s,i,o,r,a,c,l;return(null===(n=null==t?void 0:t.start)||void 0===n?void 0:n.sectionIdx)!==(null===(s=null==e?void 0:e.start)||void 0===s?void 0:s.sectionIdx)||(null===(i=null==t?void 0:t.end)||void 0===i?void 0:i.sectionIdx)!==(null===(o=null==e?void 0:e.end)||void 0===o?void 0:o.sectionIdx)||(null===(r=null==t?void 0:t.start)||void 0===r?void 0:r.time)!==(null===(a=null==e?void 0:e.start)||void 0===a?void 0:a.time)||(null===(c=null==t?void 0:t.end)||void 0===c?void 0:c.time)!==(null===(l=null==e?void 0:e.end)||void 0===l?void 0:l.time)})),qe=(Fe=.05,wt($e,((t,e)=>{const n=setTimeout((()=>e(t)),1e3*Fe);return()=>clearTimeout(n)})));var Fe;const je="14.7.77";var Le="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function We(t){var e={exports:{}};return t(e,e.exports),e.exports}var Be=We((function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0})),Ue=We((function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var s,i,o=[],r=!0,a=!1;try{for(n=n.call(t);!(r=(s=n.next()).done)&&(o.push(s.value),!e||o.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==n.return||n.return()}finally{if(a)throw i}}return o}},t.exports.default=t.exports,t.exports.__esModule=!0})),ze=We((function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s},t.exports.default=t.exports,t.exports.__esModule=!0})),Ge=We((function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return ze(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ze(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0})),Xe=We((function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0})),Ye=We((function(t){t.exports=function(t,e){return Be(t)||Ue(t,e)||Ge(t,e)||Xe()},t.exports.default=t.exports,t.exports.__esModule=!0})),Ze=We((function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0})),He=We((function(t){function e(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}t.exports=function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t},t.exports.default=t.exports,t.exports.__esModule=!0})),Qe=We((function(t,e){!function(t,e,n,s){function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=i(e),r=i(n),a=i(s),c=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},l=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},u=function(t,e){return{startTime:e,type:"setValue",value:t}},h=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},d=function(t,e,n){var s=n.startTime,i=n.target,o=n.timeConstant;return i+(e-i)*Math.exp((s-t)/o)},p=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},m=function(t){return p(t)||f(t)},g=function(t){return"setValue"===t.type},_=function(t){return"setValueCurve"===t.type},v=function t(e,n,s,i){var o=e[n];return void 0===o?i:m(o)||g(o)?o.value:_(o)?o.values[o.values.length-1]:d(s,t(e,n-1,o.startTime,i),o)},y=function(t,e,n,s,i){return void 0===n?[s.insertTime,i]:m(n)?[n.endTime,n.value]:g(n)?[n.startTime,n.value]:_(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,v(t,e-1,n.startTime,i)]},w=function(t){return"cancelAndHold"===t.type},x=function(t){return"cancelScheduledValues"===t.type},b=function(t){return w(t)||x(t)?t.cancelTime:p(t)||f(t)?t.endTime:t.startTime},T=function(t,e,n,s){var i=s.endTime,o=s.value;return n===o?o:0<n&&0<o||n<0&&o<0?n*Math.pow(o/n,(t-e)/(i-e)):0},C=function(t,e,n,s){return n+(t-e)/(s.endTime-e)*(s.value-n)},A=function(t,e){var n=Math.floor(e),s=Math.ceil(e);return n===s?t[n]:(1-(e-n))*t[n]+(1-(s-e))*t[s]},S=function(t,e){var n=e.duration,s=e.startTime,i=e.values,o=(t-s)/n*(i.length-1);return A(i,o)},k=function(t){return"setTarget"===t.type},O=function(t){function e(t){r.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return a.default(e,[{key:t,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=b(t);if(w(t)||x(t)){var n=this._automationEvents.findIndex((function(n){return x(t)&&_(n)?n.startTime+n.duration>=e:b(n)>=e})),s=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),w(t)){var i=this._automationEvents[this._automationEvents.length-1];if(void 0!==s&&m(s)){if(k(i))throw new Error("The internal list is malformed.");var o=_(i)?i.startTime+i.duration:b(i),r=_(i)?i.values[i.values.length-1]:i.value,a=p(s)?T(e,o,r,s):C(e,o,r,s),d=p(s)?c(a,e,this._currenTime):l(a,e,this._currenTime);this._automationEvents.push(d)}void 0!==i&&k(i)&&this._automationEvents.push(u(this.getValue(e),e)),void 0!==i&&_(i)&&i.startTime+i.duration>e&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),i.startTime,e-i.startTime))}}else{var g=this._automationEvents.findIndex((function(t){return b(t)>e})),v=-1===g?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[g-1];if(void 0!==v&&_(v)&&b(v)+v.duration>e)return!1;var y=p(t)?c(t.value,t.endTime,this._currenTime):f(t)?l(t.value,e,this._currenTime):t;if(-1===g)this._automationEvents.push(y);else{if(_(t)&&e+t.duration>b(this._automationEvents[g]))return!1;this._automationEvents.splice(g,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return b(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),s=n[0];k(s)&&n.unshift(u(v(this._automationEvents,e-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents.findIndex((function(e){return b(e)>t})),n=this._automationEvents[e],s=(-1===e?this._automationEvents.length:e)-1,i=this._automationEvents[s];if(void 0!==i&&k(i)&&(void 0===n||!m(n)||n.insertTime>t))return d(t,v(this._automationEvents,s-1,i.startTime,this._defaultValue),i);if(void 0!==i&&g(i)&&(void 0===n||!m(n)))return i.value;if(void 0!==i&&_(i)&&(void 0===n||!m(n)||i.startTime+i.duration>t))return t<i.startTime+i.duration?S(t,i):i.values[i.values.length-1];if(void 0!==i&&m(i)&&(void 0===n||!m(n)))return i.value;if(void 0!==n&&p(n)){var r=y(this._automationEvents,s,i,n,this._defaultValue),a=o.default(r,2),c=a[0],l=a[1];return T(t,c,l,n)}if(void 0!==n&&f(n)){var u=y(this._automationEvents,s,i,n,this._defaultValue),h=o.default(u,2),w=h[0],x=h[1];return C(t,w,x,n)}return this._defaultValue}}]),e}(Symbol.iterator),M=function(t){return{cancelTime:t,type:"cancelAndHold"}},E=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},D=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},I=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},N=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=O,t.createCancelAndHoldAutomationEvent=M,t.createCancelScheduledValuesAutomationEvent=E,t.createExponentialRampToValueAutomationEvent=D,t.createLinearRampToValueAutomationEvent=I,t.createSetTargetAutomationEvent=N,t.createSetValueAutomationEvent=u,t.createSetValueCurveAutomationEvent=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,Ye,Ze,He)}));const Ke=new WeakSet,Je=new WeakMap,tn=new WeakMap,en=new WeakMap,nn=new WeakMap,sn=new WeakMap,on=new WeakMap,rn=new WeakMap,an=new WeakMap,cn=new WeakMap,ln={construct:()=>ln},un=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,hn=(t,e)=>{const n=[];let s=t.replace(/^[\s]+/,""),i=s.match(un);for(;null!==i;){const t=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(o),s=s.slice(i[0].length).replace(/^[\s]+/,""),i=s.match(un)}return[n.join(";"),s]},dn=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},pn=t=>{if(!(t=>{try{new new Proxy(t,ln)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},fn=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},mn=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[s]=n;return t.delete(s),s},gn=(t,e,n,s)=>{const i=fn(t,e),o=mn(i,(t=>t[0]===n&&t[1]===s));return 0===i.size&&t.delete(e),o},_n=t=>fn(on,t),vn=t=>{if(Ke.has(t))throw new Error("The AudioNode is already stored.");Ke.add(t),_n(t).forEach((t=>t(!0)))},yn=t=>"port"in t,wn=t=>{if(!Ke.has(t))throw new Error("The AudioNode is not stored.");Ke.delete(t),_n(t).forEach((t=>t(!1)))},xn=(t,e)=>{!yn(t)&&e.every((t=>0===t.size))&&wn(t)},bn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Tn=(t,e)=>t.context===e,Cn=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},An=()=>new DOMException("","IndexSizeError"),Sn=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw An();throw t}})},kn={numberOfChannels:1},On=-34028234663852886e22,Mn=-On,En=t=>Ke.has(t),Dn={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},In=t=>fn(Je,t),Nn=t=>fn(en,t),Rn=(t,e)=>{const{activeInputs:n}=In(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||Rn(n,[...e,t])}))));const s=(t=>"playbackRate"in t)(t)?[t.playbackRate]:yn(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of s){const n=Nn(t);void 0!==n&&n.activeInputs.forEach((([t])=>Rn(t,e)))}En(t)&&wn(t)},Pn=t=>{Rn(t.destination,[])},Vn=t=>"context"in t,$n=t=>Vn(t[0]),qn=(t,e,n,s)=>{for(const e of t)if(n(e)){if(s)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},Fn=(t,e,[n,s],i)=>{qn(t,[e,n,s],(t=>t[0]===e&&t[1]===n),i)},jn=(t,[e,n,s],i)=>{const o=t.get(e);void 0===o?t.set(e,new Set([[n,s]])):qn(o,[n,s],(t=>t[0]===n),i)},Ln=t=>"inputs"in t,Wn=(t,e,n,s)=>{if(Ln(e)){const i=e.inputs[s];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,s),[e,n,s]},Bn=(t,e,n)=>{for(const s of t)if(s[0]===e&&s[1]===n)return t.delete(s),s;return null},Un=(t,e)=>{if(!_n(t).delete(e))throw new Error("Missing the expected event listener.")},zn=(t,e,n)=>{const s=fn(t,e),i=mn(s,(t=>t[0]===n));return 0===s.size&&t.delete(e),i},Gn=(t,e,n,s)=>{Ln(e)?t.disconnect(e.inputs[s],n,0):t.disconnect(e,n,s)},Xn=t=>fn(tn,t),Yn=t=>fn(nn,t),Zn=t=>rn.has(t),Hn=t=>!Ke.has(t),Qn=t=>new Promise((e=>{const n=t.createScriptProcessor(256,1,1),s=t.createGain(),i=t.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const r=t.createBufferSource();r.buffer=i,r.loop=!0,r.connect(n).connect(t.destination),r.connect(s),r.disconnect(s),n.onaudioprocess=s=>{const i=s.inputBuffer.getChannelData(0);Array.prototype.some.call(i,(t=>1===t))?e(!0):e(!1),r.stop(),n.onaudioprocess=null,r.disconnect(n),n.disconnect(t.destination)},r.start()})),Kn=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},Jn=t=>"context"in t,ts=(t,e,n,s)=>{const{activeInputs:i,passiveInputs:o}=Nn(e),{outputs:r}=In(t),a=_n(t),c=r=>{const a=Xn(t),c=Yn(e);if(r){const e=zn(o,t,n);Fn(i,t,e,!1),s||Zn(t)||a.connect(c,n)}else{const e=((t,e,n)=>mn(t,(t=>t[0]===e&&t[1]===n)))(i,t,n);jn(o,e,!1),s||Zn(t)||a.disconnect(c,n)}};return!!qn(r,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(c),En(t)?Fn(i,t,[n,c],!0):jn(o,[t,n,c],!0),!0)},es=(t,e,n,s,i)=>{const[o,r]=((t,e,n,s)=>{const{activeInputs:i,passiveInputs:o}=In(e),r=Bn(i[s],t,n);if(null===r)return[gn(o,t,n,s)[2],!1];return[r[2],!0]})(t,n,s,i);if(null!==o&&(Un(t,o),!r||e||Zn(t)||Gn(Xn(t),Xn(n),s,i)),En(n)){const{activeInputs:t}=In(n);xn(n,t)}},ns=(t,e,n,s)=>{const[i,o]=((t,e,n)=>{const{activeInputs:s,passiveInputs:i}=Nn(e),o=Bn(s,t,n);if(null===o)return[zn(i,t,n)[1],!1];return[o[2],!0]})(t,n,s);null!==i&&(Un(t,i),!o||e||Zn(t)||Xn(t).disconnect(Yn(n),s))};class ss{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,s)=>t.call(e,n,s,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const is={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function os(t,e,n,s,i){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],s,i);else{const o=t.getChannelData(s);if(0===e[n].byteLength)e[n]=o.slice(i,i+128);else{const t=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const rs=(t,e,n,s,i)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],s,i):0!==e[n].byteLength&&t.getChannelData(s).set(e[n],i)},as=(t,e)=>{const n=[];for(let s=0;s<t;s+=1){const t=[],i="number"==typeof e?e:e[s];for(let e=0;e<i;e+=1)t.push(new Float32Array(128));n.push(t)}return n},cs=async(t,e,n,s,i,o,r)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,c=s.channelCount*s.numberOfInputs,l=i.reduce(((t,e)=>t+e),0),u=0===l?null:n.createBuffer(l,a,n.sampleRate);if(void 0===o)throw new Error("Missing the processor constructor.");const h=In(t),d=await((t,e)=>{const n=fn(cn,t),s=Xn(e);return fn(n,s)})(n,t),p=as(s.numberOfInputs,s.channelCount),f=as(s.numberOfOutputs,i),m=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let l=0;l<a;l+=128){if(s.numberOfInputs>0&&null!==e)for(let t=0;t<s.numberOfInputs;t+=1)for(let n=0;n<s.channelCount;n+=1)os(e,p[t],n,n,l);void 0!==o.parameterDescriptors&&null!==e&&o.parameterDescriptors.forEach((({name:t},n)=>{os(e,m,t,c+n,l)}));for(let t=0;t<s.numberOfInputs;t+=1)for(let e=0;e<i[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=p.map(((t,e)=>0===h.activeInputs[e].size?[]:t)),e=r(l/n.sampleRate,n.sampleRate,(()=>d.process(t,f,m)));if(null!==u)for(let t=0,e=0;t<s.numberOfOutputs;t+=1){for(let n=0;n<i[t];n+=1)rs(u,f[t],n,e+n,l);e+=i[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return u},ls={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},us={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},hs={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ds={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},ps={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},fs=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise((s=>{const i=()=>{n.onmessage=null,e.close(),n.close(),s()};n.onmessage=()=>i();try{e.postMessage(t,[t])}finally{i()}}))},ms={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},gs=(t,e,n)=>{const s=e[n];if(void 0===s)throw t();return s},_s={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},vs={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},ys=()=>new DOMException("","InvalidStateError"),ws=()=>new DOMException("","InvalidAccessError"),xs={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},bs=(t,e,n,s,i,o,r,a,c,l,u)=>{const h=l.length;let d=a;for(let a=0;a<h;a+=1){let h=n[0]*l[a];for(let e=1;e<i;e+=1){const s=d-e&c-1;h+=n[e]*o[s],h-=t[e]*r[s]}for(let t=i;t<s;t+=1)h+=n[t]*o[d-t&c-1];for(let n=i;n<e;n+=1)h-=t[n]*r[d-n&c-1];o[d]=l[a],r[d]=h,d=d+1&c-1,u[a]=h}return d},Ts={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Cs=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},As=(t,e,n)=>{const s=e[n];void 0!==s&&s!==t[n]&&(t[n]=s)},Ss=(t,e)=>{As(t,e,"channelCount"),As(t,e,"channelCountMode"),As(t,e,"channelInterpretation")},ks=t=>"function"==typeof t.getFloatTimeDomainData,Os=(t,e,n)=>{const s=e[n];void 0!==s&&s!==t[n].value&&(t[n].value=s)},Ms=t=>{t.start=(e=>(n=0,s=0,i)=>{if("number"==typeof i&&i<0||s<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,s,i)})(t.start)},Es=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},Ds=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Is=async(t,e)=>new t(await(t=>new Promise(((e,n)=>{const{port1:s,port2:i}=new MessageChannel;s.onmessage=({data:t})=>{s.close(),i.close(),e(t)},s.onmessageerror=({data:t})=>{s.close(),i.close(),n(t)},i.postMessage(t)})))(e)),Ns=(t,e)=>{const n=t.createBiquadFilter();return Ss(n,e),Os(n,e,"Q"),Os(n,e,"detune"),Os(n,e,"frequency"),Os(n,e,"gain"),As(n,e,"type"),n},Rs=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Ss(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw ys()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw ys()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw ys()}})})(n),n},Ps=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Vs=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Ss(n,e),Os(n,e,"delayTime"),n},$s=(t,e)=>{const n=t.createGain();return Ss(n,e),Os(n,e,"gain"),n};function qs(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Fs(t,e){let n=[0,0];for(let o=t.length-1;o>=0;o-=1)i=e,n=[(s=n)[0]*i[0]-s[1]*i[1],s[0]*i[1]+s[1]*i[0]],n[0]+=t[o];var s,i;return n}const js=(t,e,n,s)=>t.createScriptProcessor(e,n,s),Ls=()=>new DOMException("","NotSupportedError"),Ws={numberOfChannels:1},Bs={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Us={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},zs={disableNormalization:!1},Gs={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Xs={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Ys=(t,e,n)=>void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),Zs=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},Hs=(t,e,n,s)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:r}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(o),set:s(r)})},Qs=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(s){if(9!==s.code)throw s;Qs(t,e,n+1e-7)}},Ks=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},Js=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},ti=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},ei=(t,e)=>{const n=e.createGain();t.connect(n);const s=(e=>()=>{e.call(t,n),t.removeEventListener("ended",s)})(t.disconnect);t.addEventListener("ended",s),Ps(t,n),t.stop=(e=>{let s=!1;return(i=0)=>{if(s)try{e.call(t,i)}catch{n.gain.setValueAtTime(0,i)}else e.call(t,i),s=!0}})(t.stop)},ni=(t,e)=>n=>{const s={value:t};return Object.defineProperties(n,{currentTarget:s,target:s}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},si=(t=>(e,n,[s,i,o],r)=>{t(e[i],[n,s,o],(t=>t[0]===n&&t[1]===s),r)})(qn),ii=(t=>(e,n,[s,i,o],r)=>{const a=e.get(s);void 0===a?e.set(s,new Set([[i,n,o]])):t(a,[i,n,o],(t=>t[0]===i&&t[1]===n),r)})(qn),oi=(t=>(e,n,s,i)=>t(e[i],(t=>t[0]===n&&t[1]===s)))(mn),ri=new WeakMap,ai=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(ri),ci=(li=new Map,ui=new WeakMap,(t,e)=>{const n=ui.get(t);if(void 0!==n)return n;const s=li.get(t);if(void 0!==s)return s;try{const n=e();return n instanceof Promise?(li.set(t,n),n.catch((()=>!1)).then((e=>(li.delete(t),ui.set(t,e),e)))):(ui.set(t,n),n)}catch{return ui.set(t,!1),!1}});var li,ui;const hi="undefined"==typeof window?null:window,di=((t,e)=>(n,s)=>{const i=n.createAnalyser();if(Ss(i,s),!(s.maxDecibels>s.minDecibels))throw e();return As(i,s,"fftSize"),As(i,s,"maxDecibels"),As(i,s,"minDecibels"),As(i,s,"smoothingTimeConstant"),t(ks,(()=>ks(i)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const s=Math.max(n.length,t.fftSize);for(let t=0;t<s;t+=1)e[t]=.0078125*(n[t]-128);return e}})(i),i})(ci,An),pi=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(In),fi=((t,e,n)=>async(s,i,o,r)=>{const a=t(s),c=[...r,s];await Promise.all(a.activeInputs.map(((t,r)=>Array.from(t).filter((([t])=>!c.includes(t))).map((async([t,a])=>{const l=e(t),u=await l.render(t,i,c),h=s.context.destination;n(t)||s===h&&n(s)||u.connect(o,a,r)})))).reduce(((t,e)=>[...t,...e]),[]))})(In,pi,Zn),mi=((t,e,n)=>()=>{const s=new WeakMap;return{render(i,o,r){const a=s.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!Tn(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(o,e)}return s.set(o,a),await n(i,o,a,r),a})(i,o,r)}}})(di,Xn,fi),gi=(_i=sn,t=>{const e=_i.get(t);if(void 0===e)throw ys();return e});var _i;const vi=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(hi),yi=(t=>e=>null!==t&&e instanceof t)(vi),wi=new WeakMap,xi=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,s){if(null!==n){let i=this._listeners.get(n);void 0===i&&(i=t(this,n),"function"==typeof n&&this._listeners.set(n,i)),this._nativeEventTarget.addEventListener(e,i,s)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const s=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===s?null:s,n)}})(ni),bi=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(hi),Ti=(t=>e=>null!==t&&e instanceof t)(bi),Ci=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(hi),Ai=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(hi),Si=((t,e,n,s,i,o,r,a,c,l,u,h,d,p,f)=>class extends l{constructor(e,s,i,o){super(i),this._context=e,this._nativeAudioNode=i;const r=u(e);h(r)&&!0!==n(Qn,(()=>Qn(r)))&&(t=>{const e=new Map;t.connect=(t=>(n,s=0,i=0)=>{const o=Jn(n)?t(n,s,i):t(n,s),r=e.get(n);return void 0===r?e.set(n,[{input:i,output:s}]):r.every((t=>t.input!==i||t.output!==s))&&r.push({input:i,output:s}),o})(t.connect.bind(t)),t.disconnect=(n=>(s,i,o)=>{if(n.apply(t),void 0===s)e.clear();else if("number"==typeof s)for(const[t,n]of e){const i=n.filter((t=>t.output!==s));0===i.length?e.delete(t):e.set(t,i)}else if(e.has(s))if(void 0===i)e.delete(s);else{const t=e.get(s);if(void 0!==t){const n=t.filter((t=>t.output!==i&&(t.input!==o||void 0===o)));0===n.length?e.delete(s):e.set(s,n)}}for(const[n,s]of e)s.forEach((e=>{Jn(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)})(i),tn.set(this,i),on.set(this,new Set),"closed"!==e.state&&s&&vn(this),t(this,o,i)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw i();const l=u(this._context),h=f(l);if(d(t)||p(t))throw o();if(Vn(t)){const i=Xn(t);try{const e=Wn(this._nativeAudioNode,i,n,a),s=Hn(this);(h||s)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!s&&Hn(t)&&vn(t)}catch(t){if(12===t.code)throw o();throw t}if(e(this,t,n,a,h)){const e=c([this],t);Kn(e,s(h))}return t}const m=Yn(t);if("playbackRate"===m.name&&1024===m.maxValue)throw r();try{this._nativeAudioNode.connect(m,n),(h||Hn(this))&&this._nativeAudioNode.disconnect(m,n)}catch(t){if(12===t.code)throw o();throw t}if(ts(this,t,n,h)){const e=c([this],t);Kn(e,s(h))}}disconnect(t,e,n){let s;const r=u(this._context),l=f(r);if(void 0===t)s=((t,e)=>{const n=In(t),s=[];for(const i of n.outputs)$n(i)?es(t,e,...i):ns(t,e,...i),s.push(i[0]);return n.outputs.clear(),s})(this,l);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw i();s=((t,e,n)=>{const s=In(t),i=[];for(const o of s.outputs)o[1]===n&&($n(o)?es(t,e,...o):ns(t,e,...o),i.push(o[0]),s.outputs.delete(o));return i})(this,l,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw i();if(Vn(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw i();if(s=((t,e,n,s,i)=>{const o=In(t);return Array.from(o.outputs).filter((t=>!(t[0]!==n||void 0!==s&&t[1]!==s||void 0!==i&&t[2]!==i))).map((n=>($n(n)?es(t,e,...n):ns(t,e,...n),o.outputs.delete(n),n[0])))})(this,l,t,e,n),0===s.length)throw o()}for(const t of s){const e=c([this],t);Kn(e,a)}}})((ki=Je,(t,e,n)=>{const s=[];for(let t=0;t<n.numberOfInputs;t+=1)s.push(new Set);ki.set(t,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,s,i,o,r,a,c,l,u,h,d)=>{const p=new WeakMap;return(f,m,g,_,v)=>{const{activeInputs:y,passiveInputs:w}=o(m),{outputs:x}=o(f),b=a(f),T=o=>{const a=c(m),l=c(f);if(o){const e=gn(w,f,g,_);t(y,f,e,!1),v||h(f)||n(l,a,g,_),d(m)&&vn(m)}else{const t=s(y,f,g,_);e(w,_,t,!1),v||h(f)||i(l,a,g,_);const n=r(m);if(0===n)u(m)&&xn(m,y);else{const t=p.get(m);void 0!==t&&clearTimeout(t),p.set(m,setTimeout((()=>{u(m)&&xn(m,y)}),1e3*n))}}};return!!l(x,[m,g,_],(t=>t[0]===m&&t[1]===g&&t[2]===_),!0)&&(b.add(T),u(f)?t(y,f,[g,_,T],!0):e(w,_,[f,g,T],!0),!0)}})(si,ii,Wn,oi,Gn,In,ai,_n,Xn,qn,En,Zn,Hn),ci,((t,e,n,s,i,o)=>r=>(a,c)=>{const l=t.get(a);if(void 0===l){if(!r&&o(a)){const t=s(a),{outputs:o}=n(a);for(const n of o)if($n(n)){const i=s(n[0]);e(t,i,n[1],n[2])}else{const e=i(n[0]);t.disconnect(e,n[1])}}t.set(a,c)}else t.set(a,l+c)})(rn,Gn,In,Xn,Yn,En),An,ws,Ls,((t,e,n,s,i,o,r,a)=>(c,l)=>{const u=e.get(c);if(void 0===u)throw new Error("Missing the expected cycle count.");const h=o(c.context),d=a(h);if(u===l){if(e.delete(c),!d&&r(c)){const e=s(c),{outputs:o}=n(c);for(const n of o)if($n(n)){const i=s(n[0]);t(e,i,n[1],n[2])}else{const t=i(n[0]);e.connect(t,n[1])}}}else e.set(c,u-l)})(Wn,rn,In,Xn,Yn,gi,En,yi),((t,e,n)=>function s(i,o){const r=Vn(o)?o:n(t,o);if((t=>"delayTime"in t)(r))return[];if(i[0]===r)return[i];if(i.includes(r))return[];const{outputs:a}=e(r);return Array.from(a).map((t=>s([...i,r],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(wi,In,fn),xi,gi,Ti,Ci,Ai,yi);var ki;const Oi=((t,e,n,s,i,o)=>class extends t{constructor(t,n){const r=i(t),a={...bn,...n},c=s(r,a);super(t,!1,c,o(r)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(Si,mi,An,di,gi,yi),Mi=new WeakSet,Ei=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(hi),Di=(Ii=new Uint32Array(1),t=>(Ii[0]=t,Ii[0]));var Ii;const Ni=((t,e)=>n=>{n.copyFromChannel=(s,i,o=0)=>{const r=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=s.length;for(let t=r<0?-r:0;t+r<c&&t<u;t+=1)s[t]=l[t+r]},n.copyToChannel=(s,i,o=0)=>{const r=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=s.length;for(let t=r<0?-r:0;t+r<c&&t<u;t+=1)l[t+r]=s[t]}})(Di,An),Ri=(t=>e=>{e.copyFromChannel=(n=>(s,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return n.call(e,s,a,r)})(e.copyFromChannel),e.copyToChannel=(n=>(s,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return n.call(e,s,a,r)})(e.copyToChannel)})(Di),Pi=((t,e,n,s,i,o,r,a)=>{let c=null;return class l{constructor(l){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:h,sampleRate:d}={...kn,...l};null===c&&(c=new i(1,1,44100));const p=null!==s&&e(o,o)?new s({length:u,numberOfChannels:h,sampleRate:d}):c.createBuffer(h,u,d);if(0===p.numberOfChannels)throw n();return"function"!=typeof p.copyFromChannel?(r(p),Sn(p)):e(Cn,(()=>Cn(p)))||a(p),t.add(p),p}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===l.prototype||t.has(e)}}})(Mi,ci,Ls,Ei,vi,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(Ei),Ni,Ri),Vi=(t=>(e,n)=>{const s=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(s).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(s),s.disconnect()};n.addEventListener("ended",i)})($s),$i=((t,e,n)=>async(s,i,o,r)=>{const a=e(s);await Promise.all(Array.from(a.activeInputs).map((async([e,s])=>{const a=t(e),c=await a.render(e,i,r);n(e)||c.connect(o,s)})))})(pi,Nn,Zn),qi=(t=>(e,n,s,i)=>t(n,e,s,i))($i),Fi=((t,e,n,s,i,o,r,a,c,l,u)=>(h,d)=>{const p=h.createBufferSource();return Ss(p,d),Os(p,d,"playbackRate"),As(p,d,"buffer"),As(p,d,"loop"),As(p,d,"loopEnd"),As(p,d,"loopStart"),e(n,(()=>n(h)))||(t=>{t.start=(e=>{let n=!1;return(s=0,i=0,o)=>{if(n)throw ys();e.call(t,s,i,o),n=!0}})(t.start)})(p),e(s,(()=>s(h)))||c(p),e(i,(()=>i(h)))||l(p,h),e(o,(()=>o(h)))||Ms(p),e(r,(()=>r(h)))||u(p,h),e(a,(()=>a(h)))||Es(p),t(h,p),p})(Vi,ci,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),Ks,Js,ti,(t=>{t.start=(e=>(n=0,s=0,i)=>{const o=t.buffer,r=null===o?s:Math.min(o.duration,s);null!==o&&r>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,r,i)})(t.start)}),(t=>(e,n)=>{const s=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=s),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===s?null:n}),(t=>n=>t.call(e,null===n?s:n)))})(Hs),ei),ji=((t,e)=>(n,s,i,o)=>(t(s).replay(i),e(s,n,i,o)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(Nn),$i),Li=((t,e,n,s,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,l,u){const h=o.get(l);return void 0!==h?Promise.resolve(h):(async(c,l,u)=>{let h=n(c);const d=Tn(h,l);if(!d){const t={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(l,t),null!==r&&h.start(...r),null!==a&&h.stop(a)}return o.set(l,h),d?await t(l,c.playbackRate,h.playbackRate,u):await s(l,c.playbackRate,h.playbackRate,u),await i(c,l,h,u),h})(c,l,u)}}})(qi,Fi,Xn,ji,fi),Wi=((t,e,n,s,i,o,r,a,c,l,u,h,d)=>(p,f,m,g=null,_=null)=>{const v=new Qe.AutomationEventList(m.defaultValue),y=f?s(v):null,w={get defaultValue(){return m.defaultValue},get maxValue(){return null===g?m.maxValue:g},get minValue(){return null===_?m.minValue:_},get value(){return m.value},set value(t){m.value=t,w.setValueAtTime(t,p.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof m.cancelAndHoldAtTime)null===y&&v.flush(p.context.currentTime),v.add(i(t)),m.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===y&&v.flush(p.context.currentTime),v.add(i(t));const n=Array.from(v).pop();m.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return w},cancelScheduledValues:t=>(null===y&&v.flush(p.context.currentTime),v.add(o(t)),m.cancelScheduledValues(t),w),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===y&&v.flush(p.context.currentTime),v.add(r(t,e)),m.exponentialRampToValueAtTime(t,e),w},linearRampToValueAtTime:(t,e)=>(null===y&&v.flush(p.context.currentTime),v.add(a(t,e)),m.linearRampToValueAtTime(t,e),w),setTargetAtTime:(t,e,n)=>(null===y&&v.flush(p.context.currentTime),v.add(c(t,e,n)),m.setTargetAtTime(t,e,n),w),setValueAtTime:(t,e)=>(null===y&&v.flush(p.context.currentTime),v.add(l(t,e)),m.setValueAtTime(t,e),w),setValueCurveAtTime(t,e,n){const s=t instanceof Float32Array?t:new Float32Array(t);if(null!==h&&"webkitAudioContext"===h.name){const t=e+n,i=p.context.sampleRate,o=Math.ceil(e*i),r=Math.floor(t*i),a=r-o,c=new Float32Array(a);for(let t=0;t<a;t+=1){const r=(s.length-1)/n*((o+t)/i-e),a=Math.floor(r),l=Math.ceil(r);c[t]=a===l?s[a]:(1-(r-a))*s[a]+(1-(l-r))*s[l]}null===y&&v.flush(p.context.currentTime),v.add(u(c,e,n)),m.setValueCurveAtTime(c,e,n);const l=r/i;l<t&&d(w,c[c.length-1],l),d(w,s[s.length-1],t)}else null===y&&v.flush(p.context.currentTime),v.add(u(s,e,n)),m.setValueCurveAtTime(s,e,n);return w}};return n.set(w,m),e.set(w,p),t(w,y),w})((Bi=en,(t,e)=>{Bi.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),wi,nn,(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:s}=n;e.exponentialRampToValueAtTime(s,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:s}=n;e.linearRampToValueAtTime(s,t)}else if("setTarget"===n.type){const{startTime:t,target:s,timeConstant:i}=n;e.setTargetAtTime(s,t,i)}else if("setValue"===n.type){const{startTime:t,value:s}=n;e.setValueAtTime(s,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:s,values:i}=n;e.setValueCurveAtTime(i,s,t)}}}})),Qe.createCancelAndHoldAutomationEvent,Qe.createCancelScheduledValuesAutomationEvent,Qe.createExponentialRampToValueAutomationEvent,Qe.createLinearRampToValueAutomationEvent,Qe.createSetTargetAutomationEvent,Qe.createSetValueAutomationEvent,Qe.createSetValueCurveAutomationEvent,bi,Qs);var Bi;const Ui=((t,e,n,s,i,o,r,a)=>class extends t{constructor(t,s){const a=o(t),c={...Dn,...s},l=i(a,c),u=r(a),h=u?e():null;super(t,!1,l,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=l,this._onended=null,this._playbackRate=n(this,u,l.playbackRate,Mn,On)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){vn(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),En(this)&&wn(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(Si,Li,Wi,ys,Fi,gi,yi,ni),zi=((t,e,n,s,i,o,r,a)=>class extends t{constructor(t,n){const s=o(t),c=r(s),l=i(s,n,c);super(t,!1,l,c?e(a):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=l}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw s();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw s();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Si,(t=>{let e=null;return{render:(n,s,i)=>(null===e&&(e=(async(e,n,s)=>{const i=n.destination;return await t(e,n,i,s),i})(n,s,i)),e)}}),An,ys,((t,e)=>(n,s,i)=>{const o=n.destination;if(o.channelCount!==s)try{o.channelCount=s}catch{}i&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{value:s});const r=t(n,{channelCount:s,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(r,"channelCount",(t=>()=>t.call(r)),(t=>e=>{t.call(r,e);try{o.channelCount=e}catch(t){if(e>o.maxChannelCount)throw t}})),e(r,"channelCountMode",(t=>()=>t.call(r)),(t=>e=>{t.call(r,e),o.channelCountMode=e})),e(r,"channelInterpretation",(t=>()=>t.call(r)),(t=>e=>{t.call(r,e),o.channelInterpretation=e})),Object.defineProperty(r,"maxChannelCount",{get:()=>o.maxChannelCount}),r.connect(o),r})($s,Hs),gi,yi,fi),Gi=((t,e,n,s,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const l=o.get(a);return void 0!==l?Promise.resolve(l):(async(r,a,c)=>{let l=n(r);const u=Tn(l,a);if(!u){const t={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(a,t)}return o.set(a,l),u?(await t(a,r.Q,l.Q,c),await t(a,r.detune,l.detune,c),await t(a,r.frequency,l.frequency,c),await t(a,r.gain,l.gain,c)):(await s(a,r.Q,l.Q,c),await s(a,r.detune,l.detune,c),await s(a,r.frequency,l.frequency,c),await s(a,r.gain,l.gain,c)),await i(r,a,l,c),l})(r,a,c)}}})(qi,Ns,Xn,ji,fi),Xi=(t=>(e,n)=>t.set(e,n))(ri),Yi=((t,e,n,s,i,o,r,a)=>class extends t{constructor(t,s){const c=o(t),l={...ls,...s},u=i(c,l),h=r(c);super(t,!1,u,h?n():null),this._Q=e(this,h,u.Q,Mn,On),this._detune=e(this,h,u.detune,1200*Math.log2(Mn),-1200*Math.log2(Mn)),this._frequency=e(this,h,u.frequency,t.sampleRate/2,0),this._gain=e(this,h,u.gain,40*Math.log10(Mn),On),this._nativeBiquadFilterNode=u,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(t){if(11===t.code)throw s();throw t}if(t.length!==e.length||e.length!==n.length)throw s()}})(Si,Wi,Gi,ws,Ns,gi,yi,Xi),Zi=((t,e)=>(n,s,i)=>{const o=new Set;return n.connect=(i=>(r,a=0,c=0)=>{const l=0===o.size;if(e(r))return i.call(n,r,a,c),t(o,[r,a,c],(t=>t[0]===r&&t[1]===a&&t[2]===c),!0),l&&s(),r;i.call(n,r,a),t(o,[r,a],(t=>t[0]===r&&t[1]===a),!0),l&&s()})(n.connect),n.disconnect=(t=>(s,r,a)=>{const c=o.size>0;if(void 0===s)t.apply(n),o.clear();else if("number"==typeof s){t.call(n,s);for(const t of o)t[1]===s&&o.delete(t)}else{e(s)?t.call(n,s,r,a):t.call(n,s,r);for(const t of o)t[0]!==s||void 0!==r&&t[1]!==r||void 0!==a&&t[2]!==a||o.delete(t)}const l=0===o.size;c&&l&&i()})(n.disconnect),n})(qn,Ci),Hi=((t,e)=>(n,s)=>{const i=n.createChannelMerger(s.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,i),Ss(i,s),i})(bi,((t,e)=>(n,s)=>{s.channelCount=1,s.channelCountMode="explicit",Object.defineProperty(s,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(s,(()=>{const t=s.numberOfInputs;for(let e=0;e<t;e+=1)i.connect(s,0,e)}),(()=>i.disconnect(s)))})(ys,Zi)),Qi=((t,e,n,s,i)=>class extends t{constructor(t,o){const r=s(t),a={...us,...o};super(t,!1,n(r,a),i(r)?e():null)}})(Si,((t,e,n)=>()=>{const s=new WeakMap;return{render(i,o,r){const a=s.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!Tn(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(o,e)}return s.set(o,a),await n(i,o,a,r),a})(i,o,r)}}})(Hi,Xn,fi),Hi,gi,yi),Ki=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=s(t),c=o({...hs,...r});super(t,!1,n(a,c),i(a)?e():null)}})(Si,((t,e,n)=>()=>{const s=new WeakMap;return{render(i,o,r){const a=s.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!Tn(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(o,e)}return s.set(o,a),await n(i,o,a,r),a})(i,o,r)}}})(Rs,Xn,fi),Rs,gi,yi,(t=>({...t,channelCount:t.numberOfOutputs}))),Ji=((t,e,n,s)=>(i,{offset:o,...r})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,{...r,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const h={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2]),start(t=0){c.start.call(c,t)},stop(t=0){c.stop.call(c,t)}};return t(i,c),s(Ps(h,l),(()=>c.connect(l)),(()=>c.disconnect(l)))})(Vi,Fi,$s,Zi),to=((t,e,n,s,i)=>(o,r)=>{if(void 0===o.createConstantSource)return n(o,r);const a=o.createConstantSource();return Ss(a,r),Os(a,r,"offset"),e(s,(()=>s(o)))||Ms(a),e(i,(()=>i(o)))||Es(a),t(o,a),a})(Vi,ci,Ji,Ks,ti),eo=((t,e,n,s,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...ds,...r},l=s(a,c),u=o(a),h=u?n():null;super(t,!1,l,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=l,this._offset=e(this,u,l.offset,Mn,On),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){vn(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),En(this)&&wn(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(Si,Wi,((t,e,n,s,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,l,u){const h=o.get(l);return void 0!==h?Promise.resolve(h):(async(c,l,u)=>{let h=n(c);const d=Tn(h,l);if(!d){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(l,t),null!==r&&h.start(r),null!==a&&h.stop(a)}return o.set(l,h),d?await t(l,c.offset,h.offset,u):await s(l,c.offset,h.offset,u),await i(c,l,h,u),h})(c,l,u)}}})(qi,to,Xn,ji,fi),to,gi,yi,ni),no=((t,e)=>(n,s)=>{const i=n.createConvolver();if(Ss(i,s),s.disableNormalization===i.normalize&&(i.normalize=!s.disableNormalization),As(i,s,"buffer"),s.channelCount>2)throw t();if(e(i,"channelCount",(t=>()=>t.call(i)),(e=>n=>{if(n>2)throw t();return e.call(i,n)})),"max"===s.channelCountMode)throw t();return e(i,"channelCountMode",(t=>()=>t.call(i)),(e=>n=>{if("max"===n)throw t();return e.call(i,n)})),i})(Ls,Hs),so=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=s(t),c={...ps,...r},l=n(a,c);super(t,!1,l,i(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=l,null!==c.buffer&&o(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(Si,((t,e,n)=>()=>{const s=new WeakMap;return{render(i,o,r){const a=s.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!Tn(a,o)){const e={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(o,e)}return s.set(o,a),Ln(a)?await n(i,o,a.inputs[0],r):await n(i,o,a,r),a})(i,o,r)}}})(no,Xn,fi),no,gi,yi,Xi),io=((t,e,n,s,i,o,r)=>class extends t{constructor(t,a){const c=i(t),l={...ms,...a},u=s(c,l),h=o(c);super(t,!1,u,h?n(l.maxDelayTime):null),this._delayTime=e(this,h,u.delayTime),r(this,l.maxDelayTime)}get delayTime(){return this._delayTime}})(Si,Wi,((t,e,n,s,i)=>o=>{const r=new WeakMap;return{render(a,c,l){const u=r.get(c);return void 0!==u?Promise.resolve(u):(async(a,c,l)=>{let u=n(a);const h=Tn(u,c);if(!h){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(c,t)}return r.set(c,u),h?await t(c,a.delayTime,u.delayTime,l):await s(c,a.delayTime,u.delayTime,l),await i(a,c,u,l),u})(a,c,l)}}})(qi,Vs,Xn,ji,fi),Vs,gi,yi,Xi),oo=(t=>(e,n)=>{const s=e.createDynamicsCompressor();if(Ss(s,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return Os(s,n,"attack"),Os(s,n,"knee"),Os(s,n,"ratio"),Os(s,n,"release"),Os(s,n,"threshold"),s})(Ls),ro=((t,e,n,s,i,o,r,a)=>class extends t{constructor(t,i){const c=o(t),l={..._s,...i},u=s(c,l),h=r(c);super(t,!1,u,h?n():null),this._attack=e(this,h,u.attack),this._knee=e(this,h,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=e(this,h,u.ratio),this._release=e(this,h,u.release),this._threshold=e(this,h,u.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Si,Wi,((t,e,n,s,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const l=o.get(a);return void 0!==l?Promise.resolve(l):(async(r,a,c)=>{let l=n(r);const u=Tn(l,a);if(!u){const t={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(a,t)}return o.set(a,l),u?(await t(a,r.attack,l.attack,c),await t(a,r.knee,l.knee,c),await t(a,r.ratio,l.ratio,c),await t(a,r.release,l.release,c),await t(a,r.threshold,l.threshold,c)):(await s(a,r.attack,l.attack,c),await s(a,r.knee,l.knee,c),await s(a,r.ratio,l.ratio,c),await s(a,r.release,l.release,c),await s(a,r.threshold,l.threshold,c)),await i(r,a,l,c),l})(r,a,c)}}})(qi,oo,Xn,ji,fi),oo,Ls,gi,yi,Xi),ao=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...vs,...r},l=s(a,c),u=o(a);super(t,!1,l,u?n():null),this._gain=e(this,u,l.gain,Mn,On)}get gain(){return this._gain}})(Si,Wi,((t,e,n,s,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const l=o.get(a);return void 0!==l?Promise.resolve(l):(async(r,a,c)=>{let l=n(r);const u=Tn(l,a);if(!u){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(a,t)}return o.set(a,l),u?await t(a,r.gain,l.gain,c):await s(a,r.gain,l.gain,c),await i(r,a,l,c),l})(r,a,c)}}})(qi,$s,Xn,ji,fi),$s,gi,yi),co=((t,e,n,s)=>(i,o,{channelCount:r,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const h=Ds(o,i.sampleRate),d=l instanceof Float64Array?l:new Float64Array(l),p=u instanceof Float64Array?u:new Float64Array(u),f=d.length,m=p.length,g=Math.min(f,m);if(0===f||f>20)throw s();if(0===d[0])throw e();if(0===m||m>20)throw s();if(0===p[0])throw e();if(1!==d[0]){for(let t=0;t<m;t+=1)p[t]/=d[0];for(let t=1;t<f;t+=1)d[t]/=d[0]}const _=n(i,h,r,r);_.channelCount=r,_.channelCountMode=a,_.channelInterpretation=c;const v=[],y=[],w=[];for(let t=0;t<r;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),w.push(e)}_.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,s=e.numberOfChannels;for(let t=0;t<s;t+=1){const s=e.getChannelData(t),i=n.getChannelData(t);v[t]=bs(d,f,p,m,g,y[t],w[t],v[t],32,s,i)}};const x=i.sampleRate/2;return Ps({get bufferSize(){return h},get channelCount(){return _.channelCount},set channelCount(t){_.channelCount=t},get channelCountMode(){return _.channelCountMode},set channelCountMode(t){_.channelCountMode=t},get channelInterpretation(){return _.channelInterpretation},set channelInterpretation(t){_.channelInterpretation=t},get context(){return _.context},get inputs(){return[_]},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},addEventListener:(...t)=>_.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>_.dispatchEvent(t[0]),getFrequencyResponse(e,n,s){if(e.length!==n.length||n.length!==s.length)throw t();const i=e.length;for(let t=0;t<i;t+=1){const i=-Math.PI*(e[t]/x),o=[Math.cos(i),Math.sin(i)],r=qs(Fs(p,o),Fs(d,o));n[t]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),s[t]=Math.atan2(r[1],r[0])}},removeEventListener:(...t)=>_.removeEventListener(t[0],t[1],t[2])},_)})(ws,ys,js,Ls),lo=((t,e,n,s)=>i=>t(Cs,(()=>Cs(i)))?Promise.resolve(t(s,s)).then((t=>{if(!t){const t=n(i,512,0,1);i.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>i.currentTime,t.connect(i.destination)}return i.startRendering()})):new Promise((t=>{const n=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(i.destination),i.startRendering()})))(ci,$s,js,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),s=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{s.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})($s,vi)),uo=((t,e,n,s,i)=>(o,r)=>{const a=new WeakMap;let c=null;const l=async(l,u,h)=>{let d=null,p=e(l);const f=Tn(p,u);if(void 0===u.createIIRFilter?d=t(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(p=u.createIIRFilter(r,o)),a.set(u,null===d?p:d),null!==d){if(null===c){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(l.context.destination.channelCount,l.context.length,u.sampleRate);c=(async()=>{await s(l,t,t.destination,h);return((t,e,n,s)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=s instanceof Float64Array?s:new Float64Array(s),r=i.length,a=o.length,c=Math.min(r,a);if(1!==i[0]){for(let t=0;t<r;t+=1)o[t]/=i[0];for(let t=1;t<a;t+=1)i[t]/=i[0]}const l=new Float32Array(32),u=new Float32Array(32),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let e=0;e<d;e+=1){const n=t.getChannelData(e),s=h.getChannelData(e);l.fill(0),u.fill(0),bs(i,r,o,a,c,l,u,0,32,n,s)}return h})(await i(t),u,o,r)})()}const t=await c;return d.buffer=t,d.start(0),d}return await s(l,u,p,h),p};return{render(t,e,n){const s=a.get(e);return void 0!==s?Promise.resolve(s):l(t,e,n)}}})(Fi,Xn,vi,fi,lo),ho=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=s(t),c=i(a),l={...xs,...r},u=e(a,c?null:t.baseLatency,l);super(t,!1,u,c?n(l.feedback,l.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,s,i)=>{if(n.length!==s.length||s.length!==i.length)throw ws();return e.call(t,n,s,i)})})(u),this._nativeIIRFilterNode=u,o(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(Si,(t=>(e,n,s)=>{if(void 0===e.createIIRFilter)return t(e,n,s);const i=e.createIIRFilter(s.feedforward,s.feedback);return Ss(i,s),i})(co),uo,gi,yi,Xi),po=((t,e,n,s,i,o,r,a)=>(c,l)=>{const u=l.listener,{forwardX:h,forwardY:d,forwardZ:p,positionX:f,positionY:m,positionZ:g,upX:_,upY:v,upZ:y}=void 0===u.forwardX?(()=>{const h=new Float32Array(1),d=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),p=r(l);let f=!1,m=[0,0,-1,0,1,0],g=[0,0,0];const _=()=>{if(f)return;f=!0;const t=s(l,256,9,0);t.onaudioprocess=({inputBuffer:t})=>{const e=[o(t,h,0),o(t,h,1),o(t,h,2),o(t,h,3),o(t,h,4),o(t,h,5)];e.some(((t,e)=>t!==m[e]))&&(u.setOrientation(...e),m=e);const n=[o(t,h,6),o(t,h,7),o(t,h,8)];n.some(((t,e)=>t!==g[e]))&&(u.setPosition(...n),g=n)},d.connect(t)},v=t=>e=>{e!==m[t]&&(m[t]=e,u.setOrientation(...m))},y=t=>e=>{e!==g[t]&&(g[t]=e,u.setPosition(...g))},w=(e,s,o)=>{const r=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:s});r.connect(d,0,e),r.start(),Object.defineProperty(r.offset,"defaultValue",{get:()=>s});const u=t({context:c},p,r.offset,Mn,On);var h,f,m,g,v,y,w;return a(u,"value",(t=>()=>t.call(u)),(t=>e=>{try{t.call(u,e)}catch(t){if(9!==t.code)throw t}_(),p&&o(e)})),u.cancelAndHoldAtTime=(h=u.cancelAndHoldAtTime,p?()=>{throw i()}:(...t)=>{const e=h.apply(u,t);return _(),e}),u.cancelScheduledValues=(f=u.cancelScheduledValues,p?()=>{throw i()}:(...t)=>{const e=f.apply(u,t);return _(),e}),u.exponentialRampToValueAtTime=(m=u.exponentialRampToValueAtTime,p?()=>{throw i()}:(...t)=>{const e=m.apply(u,t);return _(),e}),u.linearRampToValueAtTime=(g=u.linearRampToValueAtTime,p?()=>{throw i()}:(...t)=>{const e=g.apply(u,t);return _(),e}),u.setTargetAtTime=(v=u.setTargetAtTime,p?()=>{throw i()}:(...t)=>{const e=v.apply(u,t);return _(),e}),u.setValueAtTime=(y=u.setValueAtTime,p?()=>{throw i()}:(...t)=>{const e=y.apply(u,t);return _(),e}),u.setValueCurveAtTime=(w=u.setValueCurveAtTime,p?()=>{throw i()}:(...t)=>{const e=w.apply(u,t);return _(),e}),u};return{forwardX:w(0,0,v(0)),forwardY:w(1,0,v(1)),forwardZ:w(2,-1,v(2)),positionX:w(6,0,y(0)),positionY:w(7,0,y(1)),positionZ:w(8,0,y(2)),upX:w(3,0,v(3)),upY:w(4,1,v(4)),upZ:w(5,0,v(5))}})():u;return{get forwardX(){return h},get forwardY(){return d},get forwardZ(){return p},get positionX(){return f},get positionY(){return m},get positionZ(){return g},get upX(){return _},get upY(){return v},get upZ(){return y}}})(Wi,Hi,to,js,Ls,Ys,yi,Hs),fo=new WeakMap,mo=((t,e,n,s,i,o)=>class extends n{constructor(n,o){super(n),this._nativeContext=n,sn.set(this,n),s(n)&&i.set(n,new Set),this._destination=new t(this,o),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?o(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(zi,po,xi,yi,fo,ni),go=((t,e,n,s,i,o)=>(r,a)=>{const c=r.createOscillator();return Ss(c,a),Os(c,a,"detune"),Os(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):As(c,a,"type"),e(n,(()=>n(r)))||Ms(c),e(s,(()=>s(r)))||o(c,r),e(i,(()=>i(r)))||Es(c),t(r,c),c})(Vi,ci,Ks,Js,ti,ei),_o=((t,e,n,s,i)=>()=>{const o=new WeakMap;let r=null,a=null,c=null;return{set periodicWave(t){r=t},set start(t){a=t},set stop(t){c=t},render(l,u,h){const d=o.get(u);return void 0!==d?Promise.resolve(d):(async(l,u,h)=>{let d=n(l);const p=Tn(d,u);if(!p){const t={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:null===r?void 0:r,type:d.type};d=e(u,t),null!==a&&d.start(a),null!==c&&d.stop(c)}return o.set(u,d),p?(await t(u,l.detune,d.detune,h),await t(u,l.frequency,d.frequency,h)):(await s(u,l.detune,d.detune,h),await s(u,l.frequency,d.frequency,h)),await i(l,u,d,h),d})(l,u,h)}}})(qi,go,Xn,ji,fi),vo=((t,e,n,s,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...Bs,...r},l=n(a,c),u=o(a),h=u?s():null,d=t.sampleRate/2;super(t,!1,l,h),this._detune=e(this,u,l.detune,153600,-153600),this._frequency=e(this,u,l.frequency,d,-d),this._nativeOscillatorNode=l,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){vn(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),En(this)&&wn(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(Si,Wi,go,_o,gi,yi,ni),yo=(t=>(e,n)=>{const s=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return s.buffer=i,s.loop=!0,s.connect(n),s.start(),()=>{s.stop(),s.disconnect(n)}})(Fi),wo=((t,e,n,s,i)=>(o,{curve:r,oversample:a,...c})=>{const l=o.createWaveShaper(),u=o.createWaveShaper();Ss(l,c),Ss(u,c);const h=n(o,{...c,gain:1}),d=n(o,{...c,gain:-1}),p=n(o,{...c,gain:1}),f=n(o,{...c,gain:-1});let m=null,g=!1,_=null;const v={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){h.channelCount=t,d.channelCount=t,l.channelCount=t,p.channelCount=t,u.channelCount=t,f.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){h.channelCountMode=t,d.channelCountMode=t,l.channelCountMode=t,p.channelCountMode=t,u.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t,d.channelInterpretation=t,l.channelInterpretation=t,p.channelInterpretation=t,u.channelInterpretation=t,f.channelInterpretation=t},get context(){return l.context},get curve(){return _},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)l.curve=n,u.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),s=new Float32Array(t+2-t%2);e[0]=n[0],s[0]=-n[t-1];const i=Math.ceil((t+1)/2),o=(t+1)/2-1;for(let r=1;r<i;r+=1){const a=r/i*o,c=Math.floor(a),l=Math.ceil(a);e[r]=c===l?n[c]:(1-(a-c))*n[c]+(1-(l-a))*n[l],s[r]=c===l?-n[t-1-c]:-(1-(a-c))*n[t-1-c]-(1-(l-a))*n[t-1-l]}e[i]=t%2==1?n[i-1]:(n[i-2]+n[i-1])/2,l.curve=e,u.curve=s}_=n,g&&(s(_)&&null===m?m=t(o,h):null!==m&&(m(),m=null))},get inputs(){return[h]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(t){l.oversample=t,u.oversample=t},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2])};null!==r&&(v.curve=r instanceof Float32Array?r:new Float32Array(r)),a!==v.oversample&&(v.oversample=a);return i(Ps(v,p),(()=>{h.connect(l).connect(p),h.connect(d).connect(u).connect(f).connect(p),g=!0,s(_)&&(m=t(o,h))}),(()=>{h.disconnect(l),l.disconnect(p),h.disconnect(d),d.disconnect(u),u.disconnect(f),f.disconnect(p),g=!1,null!==m&&(m(),m=null)}))})(yo,ys,$s,Zs,Zi),xo=((t,e,n,s,i,o,r)=>(a,c)=>{const l=a.createWaveShaper();if(null!==o&&"webkitAudioContext"===o.name&&void 0===a.createGain().gain.automationRate)return n(a,c);Ss(l,c);const u=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==u&&u.length<2)throw e();As(l,{curve:u},"curve"),As(l,c,"oversample");let h=null,d=!1;r(l,"curve",(t=>()=>t.call(l)),(e=>n=>(e.call(l,n),d&&(s(n)&&null===h?h=t(a,l):s(n)||null===h||(h(),h=null)),n)));return i(l,(()=>{d=!0,s(l.curve)&&(h=t(a,l))}),(()=>{d=!1,null!==h&&(h(),h=null)}))})(yo,ys,wo,Zs,Zi,bi,Hs),bo=(t=>(e,n)=>{const s=e.createPanner();return void 0===s.orientationX?t(e,n):(Ss(s,n),Os(s,n,"orientationX"),Os(s,n,"orientationY"),Os(s,n,"orientationZ"),Os(s,n,"positionX"),Os(s,n,"positionY"),Os(s,n,"positionZ"),As(s,n,"coneInnerAngle"),As(s,n,"coneOuterAngle"),As(s,n,"coneOuterGain"),As(s,n,"distanceModel"),As(s,n,"maxDistance"),As(s,n,"panningModel"),As(s,n,"refDistance"),As(s,n,"rolloffFactor"),s)})(((t,e,n,s,i,o,r,a,c,l)=>(u,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:p,distanceModel:f,maxDistance:m,orientationX:g,orientationY:_,orientationZ:v,panningModel:y,positionX:w,positionY:x,positionZ:b,refDistance:T,rolloffFactor:C,...A})=>{const S=u.createPanner();if(A.channelCount>2)throw r();if("max"===A.channelCountMode)throw r();Ss(S,A);const k={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},O=n(u,{...k,channelInterpretation:"speakers",numberOfInputs:6}),M=s(u,{...A,gain:1}),E=s(u,{...k,gain:1}),D=s(u,{...k,gain:0}),I=s(u,{...k,gain:0}),N=s(u,{...k,gain:0}),R=s(u,{...k,gain:0}),P=s(u,{...k,gain:0}),V=i(u,256,6,1),$=o(u,{...k,curve:new Float32Array([1,1]),oversample:"none"});let q=[g,_,v],F=[w,x,b];const j=new Float32Array(1);V.onaudioprocess=({inputBuffer:t})=>{const e=[c(t,j,0),c(t,j,1),c(t,j,2)];e.some(((t,e)=>t!==q[e]))&&(S.setOrientation(...e),q=e);const n=[c(t,j,3),c(t,j,4),c(t,j,5)];n.some(((t,e)=>t!==F[e]))&&(S.setPosition(...n),F=n)},Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0});const L={get bufferSize(){},get channelCount(){return S.channelCount},set channelCount(t){if(t>2)throw r();M.channelCount=t,S.channelCount=t},get channelCountMode(){return S.channelCountMode},set channelCountMode(t){if("max"===t)throw r();M.channelCountMode=t,S.channelCountMode=t},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(t){M.channelInterpretation=t,S.channelInterpretation=t},get coneInnerAngle(){return S.coneInnerAngle},set coneInnerAngle(t){S.coneInnerAngle=t},get coneOuterAngle(){return S.coneOuterAngle},set coneOuterAngle(t){S.coneOuterAngle=t},get coneOuterGain(){return S.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();S.coneOuterGain=t},get context(){return S.context},get distanceModel(){return S.distanceModel},set distanceModel(t){S.distanceModel=t},get inputs(){return[M]},get maxDistance(){return S.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;S.maxDistance=t},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},get orientationX(){return E.gain},get orientationY(){return D.gain},get orientationZ(){return I.gain},get panningModel(){return S.panningModel},set panningModel(t){S.panningModel=t},get positionX(){return N.gain},get positionY(){return R.gain},get positionZ(){return P.gain},get refDistance(){return S.refDistance},set refDistance(t){if(t<0)throw new RangeError;S.refDistance=t},get rolloffFactor(){return S.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;S.rolloffFactor=t},addEventListener:(...t)=>M.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>M.dispatchEvent(t[0]),removeEventListener:(...t)=>M.removeEventListener(t[0],t[1],t[2])};h!==L.coneInnerAngle&&(L.coneInnerAngle=h),d!==L.coneOuterAngle&&(L.coneOuterAngle=d),p!==L.coneOuterGain&&(L.coneOuterGain=p),f!==L.distanceModel&&(L.distanceModel=f),m!==L.maxDistance&&(L.maxDistance=m),g!==L.orientationX.value&&(L.orientationX.value=g),_!==L.orientationY.value&&(L.orientationY.value=_),v!==L.orientationZ.value&&(L.orientationZ.value=v),y!==L.panningModel&&(L.panningModel=y),w!==L.positionX.value&&(L.positionX.value=w),x!==L.positionY.value&&(L.positionY.value=x),b!==L.positionZ.value&&(L.positionZ.value=b),T!==L.refDistance&&(L.refDistance=T),C!==L.rolloffFactor&&(L.rolloffFactor=C),1===q[0]&&0===q[1]&&0===q[2]||S.setOrientation(...q),0===F[0]&&0===F[1]&&0===F[2]||S.setPosition(...F);return l(Ps(L,S),(()=>{M.connect(S),t(M,$,0,0),$.connect(E).connect(O,0,0),$.connect(D).connect(O,0,1),$.connect(I).connect(O,0,2),$.connect(N).connect(O,0,3),$.connect(R).connect(O,0,4),$.connect(P).connect(O,0,5),O.connect(V).connect(u.destination)}),(()=>{M.disconnect(S),a(M,$,0,0),$.disconnect(E),E.disconnect(O),$.disconnect(D),D.disconnect(O),$.disconnect(I),I.disconnect(O),$.disconnect(N),N.disconnect(O),$.disconnect(R),R.disconnect(O),$.disconnect(P),P.disconnect(O),O.disconnect(V),V.disconnect(u.destination)}))})(Wn,ys,Hi,$s,js,xo,Ls,Gn,Ys,Zi)),To=((t,e,n,s,i,o,r,a,c,l)=>()=>{const u=new WeakMap;let h=null;return{render(d,p,f){const m=u.get(p);return void 0!==m?Promise.resolve(m):(async(d,p,f)=>{let m=null,g=o(d);const _={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation},v={..._,coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,panningModel:g.panningModel,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor},y=Tn(g,p);if("bufferSize"in g)m=s(p,{..._,gain:1});else if(!y){const t={...v,orientationX:g.orientationX.value,orientationY:g.orientationY.value,orientationZ:g.orientationZ.value,positionX:g.positionX.value,positionY:g.positionY.value,positionZ:g.positionZ.value};g=i(p,t)}if(u.set(p,null===m?g:m),null!==m){if(null===h){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new r(6,d.context.length,p.sampleRate),s=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});s.connect(t.destination),h=(async()=>{const e=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map((async(e,s)=>{const i=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===s?1:0});return await a(t,e,i.offset,f),i})));for(let t=0;t<6;t+=1)e[t].connect(s,0,t),e[t].start(0);return l(t)})()}const t=await h,o=s(p,{..._,gain:1});await c(d,p,o,f);const u=[];for(let e=0;e<t.numberOfChannels;e+=1)u.push(t.getChannelData(e));let g=[u[0][0],u[1][0],u[2][0]],y=[u[3][0],u[4][0],u[5][0]],w=s(p,{..._,gain:1}),x=i(p,{...v,orientationX:g[0],orientationY:g[1],orientationZ:g[2],positionX:y[0],positionY:y[1],positionZ:y[2]});o.connect(w).connect(x.inputs[0]),x.connect(m);for(let e=128;e<t.length;e+=128){const t=[u[0][e],u[1][e],u[2][e]],n=[u[3][e],u[4][e],u[5][e]];if(t.some(((t,e)=>t!==g[e]))||n.some(((t,e)=>t!==y[e]))){g=t,y=n;const r=e/p.sampleRate;w.gain.setValueAtTime(0,r),w=s(p,{..._,gain:0}),x=i(p,{...v,orientationX:g[0],orientationY:g[1],orientationZ:g[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),w.gain.setValueAtTime(1,r),o.connect(w).connect(x.inputs[0]),x.connect(m)}}return m}return y?(await t(p,d.orientationX,g.orientationX,f),await t(p,d.orientationY,g.orientationY,f),await t(p,d.orientationZ,g.orientationZ,f),await t(p,d.positionX,g.positionX,f),await t(p,d.positionY,g.positionY,f),await t(p,d.positionZ,g.positionZ,f)):(await a(p,d.orientationX,g.orientationX,f),await a(p,d.orientationY,g.orientationY,f),await a(p,d.orientationZ,g.orientationZ,f),await a(p,d.positionX,g.positionX,f),await a(p,d.positionY,g.positionY,f),await a(p,d.positionZ,g.positionZ,f)),Ln(g)?await c(d,p,g.inputs[0],f):await c(d,p,g,f),g})(d,p,f)}}})(qi,Hi,to,$s,bo,Xn,vi,ji,fi,lo),Co=((t,e,n,s,i,o,r)=>class extends t{constructor(t,a){const c=i(t),l={...Us,...a},u=n(c,l),h=o(c);super(t,!1,u,h?s():null),this._nativePannerNode=u,this._orientationX=e(this,h,u.orientationX,Mn,On),this._orientationY=e(this,h,u.orientationY,Mn,On),this._orientationZ=e(this,h,u.orientationZ,Mn,On),this._positionX=e(this,h,u.positionX,Mn,On),this._positionY=e(this,h,u.positionY,Mn,On),this._positionZ=e(this,h,u.positionZ,Mn,On),r(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(Si,Wi,bo,To,gi,yi,Xi),Ao=((t,e,n,s)=>class i{constructor(i,o){const r=e(i),a=s({...zs,...o}),c=t(r,a);return n.add(c),c}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||n.has(t)}})((t=>(e,{disableNormalization:n,imag:s,real:i})=>{const o=s instanceof Float32Array?s:new Float32Array(s),r=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(r,o,{disableNormalization:n});if(Array.from(s).length<2)throw t();return a})(An),gi,new WeakSet,(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})),So=((t,e)=>(n,s)=>{const i=s.channelCountMode;if("clamped-max"===i)throw e();if(void 0===n.createStereoPanner)return t(n,s);const o=n.createStereoPanner();return Ss(o,s),Os(o,s,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:t=>{if(t!==i)throw e()}}),o})(((t,e,n,s,i,o)=>{const r=16385,a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},h=(t,o,h,d,p)=>{if(1===o)return((t,e,i,o)=>{const h=new Float32Array(r),d=new Float32Array(r);for(let t=0;t<r;t+=1){const e=t/16384*c;h[t]=Math.cos(e),d[t]=Math.sin(e)}const p=n(t,{...l,gain:0}),f=s(t,{...u,curve:h}),m=s(t,{...u,curve:a}),g=n(t,{...l,gain:0}),_=s(t,{...u,curve:d});return{connectGraph(){e.connect(p),e.connect(void 0===m.inputs?m:m.inputs[0]),e.connect(g),m.connect(i),i.connect(void 0===f.inputs?f:f.inputs[0]),i.connect(void 0===_.inputs?_:_.inputs[0]),f.connect(p.gain),_.connect(g.gain),p.connect(o,0,0),g.connect(o,0,1)},disconnectGraph(){e.disconnect(p),e.disconnect(void 0===m.inputs?m:m.inputs[0]),e.disconnect(g),m.disconnect(i),i.disconnect(void 0===f.inputs?f:f.inputs[0]),i.disconnect(void 0===_.inputs?_:_.inputs[0]),f.disconnect(p.gain),_.disconnect(g.gain),p.disconnect(o,0,0),g.disconnect(o,0,1)}}})(t,h,d,p);if(2===o)return((t,i,o,h)=>{const d=new Float32Array(r),p=new Float32Array(r),f=new Float32Array(r),m=new Float32Array(r),g=Math.floor(8192.5);for(let t=0;t<r;t+=1)if(t>g){const e=(t-g)/(16384-g)*c;d[t]=Math.cos(e),p[t]=Math.sin(e),f[t]=0,m[t]=1}else{const e=t/(16384-g)*c;d[t]=1,p[t]=0,f[t]=Math.cos(e),m[t]=Math.sin(e)}const _=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(t,{...l,gain:0}),y=s(t,{...u,curve:d}),w=n(t,{...l,gain:0}),x=s(t,{...u,curve:p}),b=s(t,{...u,curve:a}),T=n(t,{...l,gain:0}),C=s(t,{...u,curve:f}),A=n(t,{...l,gain:0}),S=s(t,{...u,curve:m});return{connectGraph(){i.connect(_),i.connect(void 0===b.inputs?b:b.inputs[0]),_.connect(v,0),_.connect(w,0),_.connect(T,1),_.connect(A,1),b.connect(o),o.connect(void 0===y.inputs?y:y.inputs[0]),o.connect(void 0===x.inputs?x:x.inputs[0]),o.connect(void 0===C.inputs?C:C.inputs[0]),o.connect(void 0===S.inputs?S:S.inputs[0]),y.connect(v.gain),x.connect(w.gain),C.connect(T.gain),S.connect(A.gain),v.connect(h,0,0),T.connect(h,0,0),w.connect(h,0,1),A.connect(h,0,1)},disconnectGraph(){i.disconnect(_),i.disconnect(void 0===b.inputs?b:b.inputs[0]),_.disconnect(v,0),_.disconnect(w,0),_.disconnect(T,1),_.disconnect(A,1),b.disconnect(o),o.disconnect(void 0===y.inputs?y:y.inputs[0]),o.disconnect(void 0===x.inputs?x:x.inputs[0]),o.disconnect(void 0===C.inputs?C:C.inputs[0]),o.disconnect(void 0===S.inputs?S:S.inputs[0]),y.disconnect(v.gain),x.disconnect(w.gain),C.disconnect(T.gain),S.disconnect(A.gain),v.disconnect(h,0,0),T.disconnect(h,0,0),w.disconnect(h,0,1),A.disconnect(h,0,1)}}})(t,h,d,p);throw i()};return(e,{channelCount:s,channelCountMode:r,pan:a,...c})=>{if("max"===r)throw i();const l=t(e,{...c,channelCount:1,channelCountMode:r,numberOfInputs:2}),u=n(e,{...c,channelCount:s,channelCountMode:r,gain:1}),d=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:p,disconnectGraph:f}=h(e,s,u,d,l);Object.defineProperty(d.gain,"defaultValue",{get:()=>0}),Object.defineProperty(d.gain,"maxValue",{get:()=>1}),Object.defineProperty(d.gain,"minValue",{get:()=>-1});const m={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){u.channelCount!==t&&(g&&f(),({connectGraph:p,disconnectGraph:f}=h(e,t,u,d,l)),g&&p()),u.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw i();u.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t},get context(){return u.context},get inputs(){return[u]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get pan(){return d.gain},addEventListener:(...t)=>u.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>u.dispatchEvent(t[0]),removeEventListener:(...t)=>u.removeEventListener(t[0],t[1],t[2])};let g=!1;return o(Ps(m,l),(()=>{p(),g=!0}),(()=>{f(),g=!1}))}})(Hi,Rs,$s,xo,Ls,Zi),Ls),ko=((t,e,n,s,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const l=o.get(a);return void 0!==l?Promise.resolve(l):(async(r,a,c)=>{let l=n(r);const u=Tn(l,a);if(!u){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(a,t)}return o.set(a,l),u?await t(a,r.pan,l.pan,c):await s(a,r.pan,l.pan,c),Ln(l)?await i(r,a,l.inputs[0],c):await i(r,a,l,c),l})(r,a,c)}}})(qi,So,Xn,ji,fi),Oo=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...Gs,...r},l=n(a,c),u=o(a);super(t,!1,l,u?s():null),this._pan=e(this,u,l.pan)}get pan(){return this._pan}})(Si,Wi,So,ko,gi,yi),Mo=((t,e,n)=>()=>{const s=new WeakMap;return{render(i,o,r){const a=s.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!Tn(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(o,e)}return s.set(o,a),Ln(a)?await n(i,o,a.inputs[0],r):await n(i,o,a,r),a})(i,o,r)}}})(xo,Xn,fi),Eo=((t,e,n,s,i,o,r)=>class extends t{constructor(t,e){const a=i(t),c={...Xs,...e},l=n(a,c);super(t,!0,l,o(a)?s():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=l,r(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(Si,ys,xo,Mo,gi,yi,Xi),Do=(t=>null!==t&&t.isSecureContext)(hi),Io=(t=>(e,n,s)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return s()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(hi),No=new WeakMap,Ro=((t,e)=>n=>{let s=t.get(n);if(void 0!==s)return s;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return s=new e(1,1,44100),t.set(n,s),s})(No,vi),Po=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(hi),Vo=Do?((t,e,n,s,i,o,r,a,c,l,u,h,d)=>{let p=0;return(f,m,g={credentials:"omit"})=>{const _=u.get(f);if(void 0!==_&&_.has(m))return Promise.resolve();const v=l.get(f);if(void 0!==v){const t=v.get(m);if(void 0!==t)return t}const y=o(f),w=void 0===y.audioWorklet?i(m).then((([t,e])=>{const[s,i]=hn(t,e);return n(`${s};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${i}\n})})(window,'_AWGS')`)})).then((()=>{const t=d._AWGS.pop();if(void 0===t)throw new SyntaxError;s(y.currentTime,y.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const s=an.get(y);if(void 0!==s){if(s.has(t))throw e();pn(n),dn(n.parameterDescriptors),s.set(t,n)}else pn(n),dn(n.parameterDescriptors),an.set(y,new Map([[t,n]]))}),y.sampleRate,void 0,void 0)))})):Promise.all([i(m),Promise.resolve(t(h,h))]).then((([[t,e],n])=>{const s=p+1;p=s;const[i,o]=hn(t,e),l=new Blob([`${i};((AudioWorkletProcessor,registerProcessor)=>{${o}\n})(${n?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${s}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),u=URL.createObjectURL(l);return y.audioWorklet.addModule(u,g).then((()=>{if(a(y))return y;const t=r(y);return t.audioWorklet.addModule(u,g).then((()=>t))})).then((t=>{if(null===c)throw new SyntaxError;try{new c(t,`__sac${s}`)}catch{throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(u)))}));return void 0===v?l.set(f,new Map([[m,w]])):v.set(m,w),w.then((()=>{const t=u.get(f);void 0===t?u.set(f,new Set([m])):t.add(m)})).finally((()=>{const t=l.get(f);void 0!==t&&t.delete(m)})),w}})(ci,Ls,(t=>e=>new Promise(((n,s)=>{if(null===t)return void s(new SyntaxError);const i=t.document.head;if(null===i)s(new SyntaxError);else{const o=t.document.createElement("script"),r=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(r),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(e,n,i,o,r)=>n===a||n===t.location.href&&1===i&&1===o?(l(),s(r),!1):null!==c?c(e,n,i,o,r):void 0,o.onerror=()=>{l(),s(new SyntaxError)},o.onload=()=>{l(),n()},o.src=a,o.type="module",i.appendChild(o)}})))(hi),Io,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw t()})((()=>new DOMException("","AbortError"))),gi,Ro,yi,Po,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new e(1,128,44100),i=URL.createObjectURL(n);let o=!1,r=!1;try{await s.audioWorklet.addModule(i);const e=new t(s,"a",{numberOfOutputs:0}),n=s.createOscillator();e.port.onmessage=()=>o=!0,e.onprocessorerror=()=>r=!0,n.connect(e),n.start(0),await s.startRendering()}catch{}finally{URL.revokeObjectURL(i)}return o&&!r})(Po,vi),hi):void 0,$o=((t,e)=>n=>t(n)||e(n))(Ti,yi),qo=((t,e,n,s,i,o,r,a,c,l,u,h,d,p,f,m,g,_,v,y)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(t,e,s){return new n({length:e,numberOfChannels:t,sampleRate:s})}createBufferSource(){return new s(this)}createChannelMerger(t=6){return new o(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new r(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(t=1){return new u(this,{maxDelayTime:t})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(t,e){return new p(this,{feedback:e,feedforward:t})}createOscillator(){return new m(this)}createPanner(){return new g(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new _(this,{...n,imag:e,real:t})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(t,e,n){return l(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t)),(t=>{throw"function"==typeof n&&n(t),t}))}})(Vo,Oi,Pi,Ui,Yi,Qi,Ki,eo,so,((t,e,n,s,i,o,r,a,c,l,u)=>(h,d)=>{const p=r(h)?h:o(h);if(i.has(d)){const t=n();return Promise.reject(t)}try{i.add(d)}catch{}return e(c,(()=>c(p)))?p.decodeAudioData(d).then((n=>(fs(d).catch((()=>{})),e(a,(()=>a(n)))||u(n),t.add(n),n))):new Promise(((e,n)=>{const i=async()=>{try{await fs(d)}catch{}},o=t=>{n(t),i()};try{p.decodeAudioData(d,(n=>{"function"!=typeof n.copyFromChannel&&(l(n),Sn(n)),t.add(n),i().then((()=>e(n)))}),(t=>{o(null===t?s():t)}))}catch(t){o(t)}}))})(Mi,ci,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,gi,$o,Cn,Cs,Ni,Ri),io,ro,ao,ho,mo,vo,Co,Ao,Oo,Eo),Fo=((t,e,n,s)=>class extends t{constructor(t,i){const o=n(t),r=e(o,i);if(s(o))throw TypeError();super(t,!0,r,null),this._nativeMediaElementAudioSourceNode=r}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Si,((t,e)=>t.createMediaElementSource(e.mediaElement)),gi,yi),jo=((t,e,n,s)=>class extends t{constructor(t,i){const o=n(t);if(s(o))throw new TypeError;const r={...Ts,...i},a=e(o,r);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Si,((t,e)=>{const n=t.createMediaStreamDestination();return Ss(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),gi,yi),Lo=((t,e,n,s)=>class extends t{constructor(t,i){const o=n(t),r=e(o,i);if(s(o))throw new TypeError;super(t,!0,r,null),this._nativeMediaStreamAudioSourceNode=r}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Si,((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const s=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(s));return Object.defineProperty(i,"mediaStream",{value:e}),i}),gi,yi),Wo=((t,e,n)=>class extends t{constructor(t,s){const i=n(t);super(t,!0,e(i,s),null)}})(Si,((t,e)=>(n,{mediaStreamTrack:s})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(s);const i=new MediaStream([s]),o=n.createMediaStreamSource(i);if("audio"!==s.kind)throw t();if(e(n))throw new TypeError;return o})(ys,yi),gi),Bo=((t,e,n,s,i,o,r,a,c)=>class extends t{constructor(t={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");let e;try{e=new c(t)}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw n();throw t}if(null===e)throw s();if(!(t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t))(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:i}=t,{sampleRate:o}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===i?512/o:"interactive"===i||void 0===i?256/o:"playback"===i?1024/o:128*Math.max(2,Math.min(128,Math.round(i*o/128)))/o,this._nativeAudioContext=e,"webkitAudioContext"===c.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Pn(this)})))}createMediaElementSource(t){return new i(this,{mediaElement:t})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(t){return new r(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(qo,ys,Ls,(()=>new DOMException("","UnknownError")),Fo,jo,Lo,Wo,bi),Uo=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(fo),zo=(t=>(e,n)=>{t(e).add(n)})(Uo),Go=(t=>(e,n,s=0,i=0)=>{const o=e[s];if(void 0===o)throw t();return Jn(n)?o.connect(n,0,i):o.connect(n,0)})(An),Xo=(t=>(e,n)=>{t(e).delete(n)})(Uo),Yo=(t=>(e,n,s,i=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?gs(t,e,n).disconnect():Jn(n)?void 0===s?e.forEach((t=>t.disconnect(n))):void 0===i?gs(t,e,s).disconnect(n,0):gs(t,e,s).disconnect(n,0,i):void 0===s?e.forEach((t=>t.disconnect(n))):gs(t,e,s).disconnect(n,0))(An),Zo=new WeakMap,Ho=((t,e)=>n=>e(t,n))(Zo,fn),Qo=((t,e,n,s,i,o,r,a,c,l,u,h,d)=>(p,f,m,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw c();const _=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(_.some((t=>t<1)))throw c();if(_.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw c();const v=g.channelCount*g.numberOfInputs,y=_.reduce(((t,e)=>t+e),0),w=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(v+w>6||y>6)throw c();const x=new MessageChannel,b=[],T=[];for(let t=0;t<g.numberOfInputs;t+=1)b.push(r(p,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),T.push(i(p,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const C=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:s}of m.parameterDescriptors){const i=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[s]?g.parameterData[s]:void 0===t?0:t});Object.defineProperties(i.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?Mn:e},minValue:{get:()=>void 0===n?On:n}}),C.push(i)}const A=s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+w)}),S=Ds(f,p.sampleRate),k=a(p,S,v+w,Math.max(1,y)),O=i(p,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),M=[];for(let t=0;t<g.numberOfOutputs;t+=1)M.push(s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:_[t]}));for(let t=0;t<g.numberOfInputs;t+=1){b[t].connect(T[t]);for(let e=0;e<g.channelCount;e+=1)T[t].connect(A,e,t*g.channelCount+e)}const E=new ss(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((({name:t},e)=>{const n=C[e];return n.connect(A,0,v+e),n.start(0),[t,n.offset]})));A.connect(k);let D=g.channelInterpretation,I=null;const N=0===g.numberOfOutputs?[k]:M,R={get bufferSize(){return S},get channelCount(){return g.channelCount},set channelCount(t){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return D},set channelInterpretation(t){for(const e of b)e.channelInterpretation=t;D=t},get context(){return k.context},get inputs(){return b},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return I},set onprocessorerror(t){"function"==typeof I&&R.removeEventListener("processorerror",I),I="function"==typeof t?t:null,"function"==typeof I&&R.addEventListener("processorerror",I)},get parameters(){return E},get port(){return x.port2},addEventListener:(...t)=>k.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,N),disconnect:l.bind(null,N),dispatchEvent:(...t)=>k.dispatchEvent(t[0]),removeEventListener:(...t)=>k.removeEventListener(t[0],t[1],t[2])},P=new Map;var V,$;x.port1.addEventListener=(V=x.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=P.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{u(p.currentTime,p.sampleRate,(()=>e(t)))},P.set(e,t[1]))}}return V.call(x.port1,t[0],t[1],t[2])}),x.port1.removeEventListener=($=x.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=P.get(t[1]);void 0!==e&&(P.delete(t[1]),t[1]=e)}return $.call(x.port1,t[0],t[1],t[2])});let q=null;Object.defineProperty(x.port1,"onmessage",{get:()=>q,set:t=>{"function"==typeof q&&x.port1.removeEventListener("message",q),q="function"==typeof t?t:null,"function"==typeof q&&(x.port1.addEventListener("message",q),x.port1.start())}}),m.prototype.port=x.port1;let F=null;((t,e,n,s)=>{let i=cn.get(t);void 0===i&&(i=new WeakMap,cn.set(t,i));const o=Is(n,s);return i.set(e,o),o})(p,R,m,g).then((t=>F=t));const j=as(g.numberOfInputs,g.channelCount),L=as(g.numberOfOutputs,_),W=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let B=!0;const U=()=>{g.numberOfOutputs>0&&k.disconnect(O);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=M[t];for(let s=0;s<_[t];s+=1)O.disconnect(n,e+s,s);e+=_[t]}},z=new Map;k.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==F){const n=h(R);for(let s=0;s<S;s+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)os(t,j[e],n,n,s);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((({name:e},n)=>{os(t,W,e,v+n,s)}));for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<_[t];e+=1)0===L[t][e].byteLength&&(L[t][e]=new Float32Array(128));try{const t=j.map(((t,e)=>{if(n[e].size>0)return z.set(e,S/128),t;const s=z.get(e);return void 0===s?[]:(t.every((t=>t.every((t=>0===t))))&&(1===s?z.delete(e):z.set(e,s-1)),t)})),i=u(p.currentTime+s/p.sampleRate,p.sampleRate,(()=>F.process(t,L,W)));B=i;for(let t=0,n=0;t<g.numberOfOutputs;t+=1){for(let i=0;i<_[t];i+=1)rs(e,L[t],i,n+i,s);n+=_[t]}}catch(t){B=!1,R.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!B){for(let t=0;t<g.numberOfInputs;t+=1){b[t].disconnect(T[t]);for(let e=0;e<g.channelCount;e+=1)T[s].disconnect(A,e,t*g.channelCount+e)}if(void 0!==m.parameterDescriptors){const t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=C[e];t.disconnect(A,0,v+e),t.stop()}}A.disconnect(k),k.onaudioprocess=null,G?U():Z();break}}}};let G=!1;const X=r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Y=()=>k.connect(X).connect(p.destination),Z=()=>{k.disconnect(X),X.disconnect()};return Y(),d(R,(()=>{if(B){Z(),g.numberOfOutputs>0&&k.connect(O);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=M[t];for(let s=0;s<_[t];s+=1)O.connect(n,e+s,s);e+=_[t]}}G=!0}),(()=>{B&&(Y(),U()),G=!1}))})(Go,An,ys,Hi,Rs,to,$s,js,Ls,Yo,Io,Ho,Zi),Ko=((t,e,n,s,i)=>(o,r,a,c,l,u)=>{if(null!==a)try{const e=new a(o,c,u),s=new Map;let r=null;if(Object.defineProperties(e,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>r,set:t=>{"function"==typeof r&&e.removeEventListener("processorerror",r),r="function"==typeof t?t:null,"function"==typeof r&&e.addEventListener("processorerror",r)}}}),e.addEventListener=(d=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=s.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},s.set(e,t[1]))}}return d.call(e,"error",t[1],t[2]),d.call(e,...t)}),e.removeEventListener=(h=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=s.get(t[1]);void 0!==e&&(s.delete(t[1]),t[1]=e)}return h.call(e,"error",t[1],t[2]),h.call(e,t[0],t[1],t[2])}),0!==u.numberOfOutputs){const t=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(o.destination);return i(e,(()=>t.disconnect()),(()=>t.connect(o.destination)))}return e}catch(t){if(11===t.code)throw s();throw t}var h,d;if(void 0===l)throw s();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(u),e(o,r,l,u)})(ys,Qo,$s,Ls,Zi),Jo=((t,e,n,s,i,o,r,a,c,l,u,h,d,p,f,m)=>(g,_,v)=>{const y=new WeakMap;let w=null;return{render(x,b,T){a(b,x);const C=y.get(b);return void 0!==C?Promise.resolve(C):(async(a,x,b)=>{let T=u(a),C=null;const A=Tn(T,x),S=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(null===h){const t=S.reduce(((t,e)=>t+e),0),n=i(x,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),o=[];for(let t=0;t<a.numberOfOutputs;t+=1)o.push(s(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:S[t]}));const l=r(x,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1});l.connect=e.bind(null,o),l.disconnect=c.bind(null,o),C=[n,o,l]}else A||(T=new h(x,g));if(y.set(x,null===C?T:C[2]),null!==C){if(null===w){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===d)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,n=t+e,c=async()=>{const c=new d(n,128*Math.ceil(a.context.length/128),x.sampleRate),l=[],u=[];for(let t=0;t<_.numberOfInputs;t+=1)l.push(r(c,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),u.push(i(c,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const h=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=o(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await p(c,t,e.offset,b),e}))),g=s(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<_.numberOfInputs;t+=1){l[t].connect(u[t]);for(let e=0;e<_.channelCount;e+=1)u[t].connect(g,e,t*_.channelCount+e)}for(const[e,n]of h.entries())n.connect(g,0,t+e),n.start(0);return g.connect(c.destination),await Promise.all(l.map((t=>f(a,c,t,b)))),m(c)};w=cs(a,0===n?null:await c(),x,_,S,v,l)}const t=await w,e=n(x,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,u,h]=C;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=u[t];for(let s=0;s<S[t];s+=1)c.connect(n,e+s,s);e+=S[t]}return h}if(A)for(const[e,n]of a.parameters.entries())await t(x,n,T.parameters.get(e),b);else for(const[t,e]of a.parameters.entries())await p(x,e,T.parameters.get(t),b);return await f(a,x,T,b),T})(x,b,T)}}})(qi,Go,Fi,Hi,Rs,to,$s,Xo,Yo,Io,Xn,Po,vi,ji,fi,lo),tr=(t=>e=>t.get(e))(No),er=(t=>(e,n)=>{t.set(e,n)})(Zo),nr=Do?((t,e,n,s,i,o,r,a,c,l,u,h,d,p)=>class extends e{constructor(e,p,f){var m;const g=a(e),_=c(g),v=u({...is,...f});d(v);const y=an.get(g),w=null==y?void 0:y.get(p),x=_||"closed"!==g.state?g:null!==(m=r(g))&&void 0!==m?m:g,b=i(x,_?null:e.baseLatency,l,p,w,v);super(e,!0,b,_?s(p,v,w):null);const T=[];b.parameters.forEach(((t,e)=>{const s=n(this,_,t);T.push([e,s])})),this._nativeAudioWorkletNode=b,this._onprocessorerror=null,this._parameters=new ss(T),_&&t(g,this);const{activeInputs:C}=o(this);h(b,C)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?p(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(zo,Si,Wi,Jo,Ko,In,tr,gi,yi,Po,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),er,(t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}}),ni):void 0,sr=((t,e)=>(n,s,i)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,s,i)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(Ls,vi),ir=((t,e,n,s,i,o,r,a)=>{const c=[];return(l,u)=>n(l).render(l,u,c).then((()=>Promise.all(Array.from(s(u)).map((t=>n(t).render(t,u,c)))))).then((()=>i(u))).then((n=>("function"!=typeof n.copyFromChannel?(r(n),Sn(n)):e(o,(()=>o(n)))||a(n),t.add(n),n)))})(Mi,ci,pi,Uo,lo,Cn,Ni,Ri),or=((t,e,n,s,i)=>class extends t{constructor(t,n,i){let o;if("number"==typeof t&&void 0!==n&&void 0!==i)o={length:n,numberOfChannels:t,sampleRate:i};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");o=t}const{length:r,numberOfChannels:a,sampleRate:c}={...Ws,...o},l=s(a,r,c);e(Cs,(()=>Cs(l)))||l.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(l.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(l,a),this._length=r,this._nativeOfflineAudioContext=l,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,Pn(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(qo,ci,ys,sr,ir),rr=((t,e)=>n=>{const s=t.get(n);return e(s)||e(n)})(sn,Ti),ar=((t,e)=>n=>t.has(n)||e(n))(tn,Ci),cr=((t,e)=>n=>t.has(n)||e(n))(nn,Ai),lr=((t,e)=>n=>{const s=t.get(n);return e(s)||e(n)})(sn,yi);function ur(t,e){if(!t)throw new Error(e)}function hr(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function dr(t){t.isOffline||"running"===t.state||fr('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let pr=console;function fr(...t){pr.warn(...t)}function mr(t){return void 0===t}function gr(t){return!mr(t)}function _r(t){return"number"==typeof t}function vr(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function yr(t){return Array.isArray(t)}function wr(t){return"string"==typeof t}function xr(t){return wr(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const br="object"==typeof self?self:null,Tr=br&&(br.hasOwnProperty("AudioContext")||br.hasOwnProperty("webkitAudioContext"));
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
function Cr(t,e,n,s){var i,o=arguments.length,r=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,s);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(o<3?i(r):o>3?i(e,n,r):i(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r}function Ar(t,e,n,s){return new(n||(n=Promise))((function(i,o){function r(t){try{c(s.next(t))}catch(t){o(t)}}function a(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((s=s.apply(t,e||[])).next())}))}class Sr{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function kr(t){return cr(t)}function Or(t){return ar(t)}function Mr(t){return lr(t)}function Er(t){return rr(t)}function Dr(t){return t instanceof AudioBuffer}function Ir(t,e){return"value"===t||kr(e)||Or(e)||Dr(e)}function Nr(t,...e){if(!e.length)return t;const n=e.shift();if(vr(t)&&vr(n))for(const e in n)Ir(e,n[e])?t[e]=n[e]:vr(n[e])?(t[e]||Object.assign(t,{[e]:{}}),Nr(t[e],n[e])):Object.assign(t,{[e]:n[e]});return Nr(t,...e)}function Rr(t,e,n=[],s){const i={},o=Array.from(e);if(vr(o[0])&&s&&!Reflect.has(o[0],s)){Object.keys(o[0]).some((e=>Reflect.has(t,e)))||(Nr(i,{[s]:o[0]}),n.splice(n.indexOf(s),1),o.shift())}if(1===o.length&&vr(o[0]))Nr(i,o[0]);else for(let t=0;t<n.length;t++)gr(o[t])&&(i[n[t]]=o[t]);return Nr(t,i)}function Pr(t,e){return mr(t)?e:t}function Vr(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}
/**
     * Tone.js
     * @author Yotam Mann
     * @license http://opensource.org/licenses/MIT MIT License
     * @copyright 2014-2019 Yotam Mann
     */class $r{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||br&&this.toString()===br.TONE_DEBUG_CLASS)&&function(...t){pr.log(...t)}(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}$r.version=je;const qr=1e-6;function Fr(t,e){return t>e+qr}function jr(t,e){return Fr(t,e)||Wr(t,e)}function Lr(t,e){return t+qr<e}function Wr(t,e){return Math.abs(t-e)<qr}class Br extends $r{constructor(){super(),this.name="Timeline",this._timeline=[];const t=Rr(Br.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(ur(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];ur(jr(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Wr(this._timeline[e].time,t)){for(let n=e;n>=0&&Wr(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&jr(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const s=this._timeline.length;let i=s;if(s>0&&this._timeline[s-1][e]<=t)return s-1;for(;n<i;){let s=Math.floor(n+(i-n)/2);const o=this._timeline[s],r=this._timeline[s+1];if(Wr(o[e],t)){for(let n=s;n<this._timeline.length;n++){if(!Wr(this._timeline[n][e],t))break;s=n}return s}if(Lr(o[e],t)&&Fr(r[e],t))return s;Fr(o[e],t)?i=s:n=s+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let s=this._search(t),i=this._search(e);return-1!==s&&-1!==i?(this._timeline[s].time!==t&&(s+=1),this._timeline[i].time===e&&(i-=1),this._iterate(n,s,i)):-1===s&&this._iterate(n,0,i),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&Wr(this._timeline[n].time,t)){let s=n;for(let e=n;e>=0&&Wr(this._timeline[e].time,t);e--)s=e;this._iterate((t=>{e(t)}),s,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Ur=[];function zr(t){Ur.push(t)}const Gr=[];function Xr(t){Gr.push(t)}class Yr extends $r{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{mr(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...s)=>{e(...s),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(mr(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(mr(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,s=n.length;t<s;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(Yr.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class Zr extends Yr{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Hr extends Zr{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Br,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=Rr(Hr.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new Bo(t)}({latencyHint:t.latencyHint}),this._ticker=new Sr(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,Ur.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){ur(Er(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaElementSource(t){ur(Er(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(t)}createMediaStreamDestination(){ur(Er(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){ur(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){ur(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){ur(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){ur(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return ur(gr(nr),"This node only works in a secure context (https or localhost)"),new nr(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return Ar(this,void 0,void 0,(function*(){ur(gr(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return Ar(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,wr(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return Er(this._context)?this._context.resume():Promise.resolve()}close(){return Ar(this,void 0,void 0,(function*(){var t;Er(this._context)&&(yield this._context.close()),this._initialized&&(t=this,Gr.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const s=this._context.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=e,s.loop=!0,s.start(0),this._constants.set(t,s),s}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,s=()=>{const i=this.now();this._timeouts.add({callback:()=>{t(),s()},id:n,time:i+e})};return s(),n}}function Qr(t,e){yr(e)?e.forEach((e=>Qr(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Kr(t,e){yr(e)?e.forEach((e=>Kr(t,e))):Object.defineProperty(t,e,{writable:!0})}const Jr=()=>{};class ta extends $r{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Jr;const t=Rr(ta.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&Dr(t.url)||t.url instanceof ta?this.set(t.url):wr(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:Jr,onload:Jr,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:ia().sampleRate}set(t){return t instanceof ta?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return Ar(this,void 0,void 0,(function*(){const e=ta.load(t).then((t=>{this.set(t),this.onload(this)}));ta.downloads.push(e);try{yield e}finally{const t=ta.downloads.indexOf(e);ta.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=yr(t)&&t[0].length>0,n=e?t.length:1,s=e?t[0].length:t.length,i=ia(),o=i.createBuffer(n,s,i.sampleRate),r=e||1!==n?t:[t];for(let t=0;t<n;t++)o.copyToChannel(r[t],t);return this._buffer=o,this}toMono(t){if(_r(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(_r(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),s=Math.floor(e*this.sampleRate);ur(n<s,"The start time must be less than the end time");const i=s-n,o=ia().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)o.copyToChannel(this.getChannelData(t).subarray(n,s),t);return new ta(o)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new ta).fromArray(t)}static fromUrl(t){return Ar(this,void 0,void 0,(function*(){const e=new ta;return yield e.load(t)}))}static load(t){return Ar(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let s=n[0];for(const t of n)if(ta.supportsType(t)){s=t;break}t=t.replace(e[0],s)}const n=""===ta.baseUrl||ta.baseUrl.endsWith("/")?ta.baseUrl:ta.baseUrl+"/",s=yield fetch(n+t);if(!s.ok)throw new Error(`could not load url: ${t}`);const i=yield s.arrayBuffer();return yield ia().decodeAudioData(i)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return Ar(this,void 0,void 0,(function*(){for(yield Promise.resolve();ta.downloads.length;)yield ta.downloads[0]}))}}ta.baseUrl="",ta.downloads=[];class ea extends Hr{constructor(){var t,e,n;super({clockSource:"offline",context:Mr(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new or(t,e,n)),lookAhead:0,updateInterval:Mr(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Mr(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Ar(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return Ar(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new ta(e)}))}close(){return Promise.resolve()}}const na=new class extends Zr{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return Ar(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let sa=na;function ia(){var t;return sa===na&&Tr&&(t=new Hr,sa=Er(t)?new Hr(t):Mr(t)?new ea(t):t),sa}if(br&&!br.TONE_SILENCE_LOGGING){const t=` * Tone.js ${"v"}14.7.77 * `;console.log(`%c${t}`,"background: #000; color: #fff")}function oa(t){return Math.pow(2,t/12)}let ra=440;function aa(t){return Math.round(ca(t))}function ca(t){return 69+12*Math.log2(t/ra)}class la extends $r{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),s="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*s:this._beatsToUnits(4/n)*s},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let s=0;return t&&"0"!==t&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(s+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(s+=this._beatsToUnits(parseFloat(n)/4)),s},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof la&&this.fromType(this._val),mr(this._val))return this._noArg();if(wr(this._val)&&mr(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(vr(this._val)){let t=0;for(const e in this._val)if(gr(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(gr(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return wr(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class ua extends la{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new ua(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),s=this.valueOf();return s+(Math.round(s/n)*n-s)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],s=new ua(this.context,e[0]).toSeconds();return e.forEach((e=>{const i=new ua(this.context,e).toSeconds();Math.abs(i-t)<Math.abs(s-t)&&(n=e,s=i)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let s=e%1*4;e=Math.floor(e)%this._getTimeSignature();const i=s.toString();i.length>3&&(s=parseFloat(parseFloat(i).toFixed(3)));return[n,e,s].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return aa(this.toFrequency())}_now(){return this.context.now()}}class ha extends ua{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return ra}static set A4(t){!function(t){ra=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:ha.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=da[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:ha.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let s=1;return t&&"0"!==t&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(s*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(s*=this._beatsToUnits(parseFloat(n)/4)),s}}})}transpose(t){return new ha(this.context,this.valueOf()*oa(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return aa(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/ha.A4);let n=Math.round(12*e)+57;const s=Math.floor(n/12);s<0&&(n+=-12*s);return pa[n%12]+s.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return function(t){return ra*Math.pow(2,(t-69)/12)}(t)}static ftom(t){return aa(t)}}const da={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},pa=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class fa extends ua{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class ma extends $r{constructor(){super();const t=Rr(ma.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:ia()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new ua(this.context,t).toSeconds()}toFrequency(t){return new ha(this.context,t).toFrequency()}toTicks(t){return new fa(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{mr(t[n])&&delete e[n]})),e}get(){const t=function(t){return t.constructor.getDefaults()}(this);return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];gr(n)&&gr(n.value)&&gr(n.setValueAtTime)?t[e]=n.value:n instanceof ma?t[e]=n._getPartialProperties(t[e]):yr(n)||_r(n)||wr(n)||"boolean"==typeof n?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&gr(this[e])&&(this[e]&&gr(this[e].value)&&gr(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof ma?this[e].set(t[e]):this[e]=t[e])})),this}}class ga extends Br{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return hr(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class _a extends ma{constructor(){super(Rr(_a.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=Rr(_a.getDefaults(),arguments,["param","units","convert"]);for(ur(gr(t.param)&&(kr(t.param)||t.param instanceof _a),"param must be an AudioParam");!kr(t.param);)t.param=t.param._param;this._swappable=!!gr(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Br(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,gr(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(ma.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return gr(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return gr(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return gr(this.maxValue)&&gr(this.minValue)&&hr(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?(e=t,Math.pow(10,e/20)):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t;var e}_toType(t){return this.convert&&"decibels"===this.units?(e=t,Math.log(e)/Math.LN10*20):t;var e}setValueAtTime(t,e){const n=this.toSeconds(e),s=this._fromType(t);return ur(isFinite(s)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(s),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),s=this._events.get(e);let i=this._initialValue;if(null===s)i=this._initialValue;else if("setTargetAtTime"!==s.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)i=s.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=s.value;if("setTargetAtTime"===s.type){const e=this._events.getBefore(s.time);t=null===e?this._initialValue:e.value}i="linearRampToValueAtTime"===n.type?this._linearInterpolate(s.time,t,n.time,n.value,e):this._exponentialInterpolate(s.time,t,n.time,n.value,e)}else i=s.value;else{const t=this._events.getBefore(s.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===s.type&&(i=this._exponentialApproach(s.time,n,s.value,s.constant,e))}return this._toType(i)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),s=this.toSeconds(e);return ur(isFinite(n)&&isFinite(s),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:s,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,s),this._param.linearRampToValueAtTime(n,s),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Wr(n,0)?this._minOutput:n,this._assertRange(n);const s=this.toSeconds(e);return ur(isFinite(n)&&isFinite(s),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:s,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,s),this._param.exponentialRampToValueAtTime(n,s),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const s=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,s),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const s=this._fromType(t);ur(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(e);return this._assertRange(s),ur(isFinite(s)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:i,type:"setTargetAtTime",value:s}),this.log(this.units,"setTargetAtTime",t,i,n),this._param.setTargetAtTime(s,i,n),this}setValueCurveAtTime(t,e,n,s=1){n=this.toSeconds(n),e=this.toSeconds(e);const i=this._fromType(t[0])*s;this.setValueAtTime(this._toType(i),e);const o=n/(t.length-1);for(let n=1;n<t.length;n++){const i=this._fromType(t[n])*s;this.linearRampToValueAtTime(this._toType(i),e+n*o)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return ur(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));ur(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const s=this._events.get(e),i=this._events.getAfter(e);return s&&Wr(s.time,e)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const s=this._events.getAfter(n.time),i=s?s.time:e+2,o=(i-e)/10;for(let n=e;n<i;n+=o)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){ur(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,s,i){return n+(e-n)*Math.exp(-(i-t)/s)}_linearInterpolate(t,e,n,s,i){return e+(i-t)/(n-t)*(s-e)}_exponentialInterpolate(t,e,n,s,i){return e*Math.pow(s/e,(i-t)/(n-t))}}class va extends ma{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return gr(this.input)?kr(this.input)||this.input instanceof _a?1:this.input.numberOfInputs:0}get numberOfOutputs(){return gr(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return gr(t)&&(t instanceof va||Or(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();ur(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return wa(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return fr("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return function(t,e,n=0,s=0){if(gr(e))for(;e instanceof va;)e=e.input;for(;!Or(t);)gr(t.output)&&(t=t.output);kr(e)?t.disconnect(e,n):Or(e)?t.disconnect(e,n,s):t.disconnect()}(this,t,e,n),this}chain(...t){return ya(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),gr(this.input)&&(this.input instanceof va?this.input.dispose():Or(this.input)&&this.input.disconnect()),gr(this.output)&&(this.output instanceof va?this.output.dispose():Or(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function ya(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof va?t.connect(e):Or(t)&&wa(t,e),e)),e)}function wa(t,e,n=0,s=0){for(ur(gr(t),"Cannot connect from undefined node"),ur(gr(e),"Cannot connect to undefined node"),(e instanceof va||Or(e))&&ur(e.numberOfInputs>0,"Cannot connect to node with no inputs"),ur(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof va||e instanceof _a;)gr(e.input)&&(e=e.input);for(;t instanceof va;)gr(t.output)&&(t=t.output);kr(e)?t.connect(e,n):t.connect(e,n,s)}class xa extends va{constructor(){super(Rr(xa.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=Rr(xa.getDefaults(),arguments,["gain","units"]);this.gain=new _a({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),Qr(this,"gain")}static getDefaults(){return Object.assign(va.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class ba extends va{constructor(t){super(t),this.onended=Jr,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new xa({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(va.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Jr})}_startGain(t,e=1){ur(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){ur(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Jr&&(this.onended(this),this.onended=Jr,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),ur(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class Ta extends ba{constructor(){super(Rr(Ta.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=Rr(Ta.getDefaults(),arguments,["offset"]);wa(this._source,this._gainNode),this.offset=new _a({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(ba.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Ca extends va{constructor(){super(Rr(Ca.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=Rr(Ca.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Ta({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(va.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return Aa(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,s){return this._param.setValueCurveAtTime(t,e,n,s),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function Aa(t,e,n,s){(e instanceof _a||kr(e)||e instanceof Ca&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Ca&&(e.overridden=!0)),wa(t,e,n,s)}class Sa extends _a{constructor(){super(Rr(Sa.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Br(1/0),this._multiplier=1;const t=Rr(Sa.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(_a.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const s=this._fromType(t),i=this._events.get(e),o=Math.round(Math.max(1/n,1));for(let t=0;t<=o;t++){const o=n*t+e,r=this._exponentialApproach(i.time,i.value,s,n,o);this.linearRampToValueAtTime(this._toType(r),o)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const s=this._events.get(n),i=this._events.previousEvent(s),o=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(o,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const s=this._events.get(n),i=this._events.previousEvent(s),o=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),s=this._events.get(e),i=Math.round(Math.max(10*(e-s.time),1)),o=(e-s.time)/i;for(let t=0;t<=i;t++){const i=o*t+s.time,r=this._exponentialInterpolate(s.time,s.value,e,n,i);this.linearRampToValueAtTime(this._toType(r),i)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(mr(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let s=this._fromType(this.getValueAtTime(e));const i=this._events.get(e);return i&&i.time===e&&"setValueAtTime"===i.type&&(s=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+s)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),s=this.getTicksAtTime(e);return this.getTimeOfTick(s+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const s=this._fromType(this.getValueAtTime(e.time)),i=(this._fromType(this.getValueAtTime(n.time))-s)/(n.time-e.time),o=Math.sqrt(Math.pow(s,2)-2*i*(e.ticks-t)),r=(-s+o)/i,a=(-s-o)/i;return(r>0?r:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),s=this.toSeconds(t),i=this.getTicksAtTime(n);return this.getTicksAtTime(n+s)-i}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class ka extends Ca{constructor(){super(Rr(ka.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=Rr(ka.getDefaults(),arguments,["value"]);this.input=this._param=new Sa({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Ca.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class Oa extends ma{constructor(){super(Rr(Oa.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new ga,this._tickOffset=new Br;const t=Rr(Oa.getDefaults(),arguments,["frequency"]);this.frequency=new ka({context:this.context,units:t.units,value:t.frequency}),Qr(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},ma.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),gr(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),s={state:"paused",time:e};this._state.add(s);let i=n,o=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(o=n.ticks,e=n.time),"started"===i.state&&"started"!==t.state&&(o+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),i=t})),this._state.remove(s),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let s=e,i=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=s.time;const n=this._tickOffset.get(t.time);n&&n.time>=s.time&&(i=n.seconds,e=n.time),"started"===s.state&&"started"!==t.state&&(i+=t.time-e),s=t})),this._state.remove(n),i}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),s=this._state.get(e),i=Math.max(n.time,s.time),o=this.frequency.getTicksAtTime(i)+t-n.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(t,e,n){let s=this._state.get(t);this._state.forEachBetween(t,e,(e=>{s&&"started"===s.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(s.time,t),e.time-this.sampleTime,n),s=e}));let i=null;if(s&&"started"===s.state){const o=Math.max(s.time,t),r=this.frequency.getTicksAtTime(o),a=r-this.frequency.getTicksAtTime(s.time);let c=Math.ceil(a)-a;c=Wr(c,1)?0:c;let l=this.frequency.getTimeOfTick(r+c);for(;l<e;){try{n(l,Math.round(this.getTicksAtTime(l)))}catch(t){i=t;break}l+=this.frequency.getDurationOfTicks(1,l)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Ma extends ma{constructor(){super(Rr(Ma.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Jr,this._lastUpdate=0,this._state=new ga("stopped"),this._boundLoop=this._loop.bind(this);const t=Rr(Ma.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Oa({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Qr(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(ma.getDefaults(),{callback:Jr,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){dr(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),s=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(s+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Yr.mixin(Ma);class Ea extends $r{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=Rr(Ea.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:Jr,onload:Jr,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return ur(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=Jr,s=Jr){return wr(e)?this._buffers.set(t.toString(),new ta(this.baseUrl+e,n,s)):this._buffers.set(t.toString(),new ta(e,n,s)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class Da extends fa{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Ia extends ma{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Br,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}zr((t=>{t.draw=new Ia({context:t})})),Xr((t=>{t.draw.dispose()}));class Na extends $r{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){ur(gr(t.time),"Events must have a time property"),ur(gr(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Ra(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),s=t.right;s&&(t.right=s.left,s.left=t),null!==e?n?e.left=s:e.right=s:this._setRoot(s)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),s=t.left;s&&(t.left=s.right,s.right=t),null!==e?n?e.left=s:e.right=s:this._setRoot(s)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class Ra{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Pa extends va{constructor(){super(Rr(Pa.getDefaults(),arguments,["volume"])),this.name="Volume";const t=Rr(Pa.getDefaults(),arguments,["volume"]);this.input=this.output=new xa({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,Qr(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(va.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Va extends va{constructor(){super(Rr(Va.getDefaults(),arguments)),this.name="Destination",this.input=new Pa({context:this.context}),this.output=new xa({context:this.context}),this.volume=this.input.volume;const t=Rr(Va.getDefaults(),arguments);ya(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(va.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),ya(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}zr((t=>{t.destination=new Va({context:t})})),Xr((t=>{t.destination.dispose()}));class $a extends $r{constructor(t){super(),this.name="TimelineValue",this._timeline=new Br({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class qa{constructor(t,e){this.id=qa._eventId++;const n=Object.assign(qa.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:Jr,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}qa._eventId=0;class Fa extends qa{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(Fa.getDefaults(),e);this.duration=new Da(t.context,n.duration).valueOf(),this._interval=new Da(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},qa.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Da(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Da(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Da(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class ja extends ma{constructor(){super(Rr(ja.getDefaults(),arguments)),this.name="Transport",this._loop=new $a(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Br,this._repeatedEvents=new Na,this._syncedSignals=[],this._swingAmount=0;const t=Rr(ja.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Ma({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),Qr(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(ma.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),s=Math.sin(n*Math.PI)*this._swingAmount;t+=new Da(this.context,2*this._swingTicks/3).toSeconds()*s}this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new qa(this,{callback:t,time:new fa(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,s=1/0){const i=new Fa(this,{callback:t,duration:new ua(this.context,s).toTicks(),interval:new ua(this.context,e).toTicks(),time:new fa(this.context,n).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(t,e){const n=new qa(this,{callback:t,once:!0,time:new fa(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new Da(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return gr(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){yr(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new ua(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new ua(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new Da(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new Da(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),s=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",s),this._clock.setTicksAtTime(t,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const s=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/s}else e=0}const n=new xa(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Kr(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Yr.mixin(ja),zr((t=>{t.transport=new ja({context:t})})),Xr((t=>{t.transport.dispose()}));class La extends va{constructor(t){super(t),this.input=void 0,this._state=new ga("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Jr,this._syncedStop=Jr,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Pa({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,Qr(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(va.getDefaults(),{mute:!1,onstop:Jr,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let s=mr(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(s=this._clampToCurrentTime(s),this._synced||"started"!==this._state.getValueAtTime(s))if(this.log("start",s),this._state.setStateAtTime("started",s),this._synced){const t=this._state.get(s);t&&(t.offset=this.toSeconds(Pr(e,0)),t.duration=n?this.toSeconds(n):void 0);const i=this.context.transport.schedule((t=>{this._start(t,e,n)}),s);this._scheduled.push(i),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>s&&this._syncedStart(this.now(),this.context.transport.seconds)}else dr(this.context),this._start(s,e,n);else ur(Fr(s,this._state.get(s).time),"Start time must be strictly greater than previous start time"),this._state.cancel(s),this._state.setStateAtTime("started",s),this.log("restart",s),this.restart(s,e,n);return this}stop(t){let e=mr(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||gr(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const s=e-this.toSeconds(n.time);let i;n.duration&&(i=this.toSeconds(n.duration)-s),this._start(t,this.toSeconds(n.offset)+s,i)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Jr,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Wa extends ba{constructor(){super(Rr(Wa.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=Rr(Wa.getDefaults(),arguments,["url","onload"]);wa(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new _a({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new ta(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(ba.getDefaults(),{url:new ta,loop:!1,loopEnd:0,loopStart:0,onload:Jr,onerror:Jr,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,s=1){ur(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(t);this._startGain(i,s),e=this.loop?Pr(e,this.loopStart):Pr(e,0);let o=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;jr(o,t)&&(o=(o-e)%n+e),Wr(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Lr(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),gr(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(i+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function Ba(t,e){return Ar(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,s=new ea(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:s})).toDestination().start(0);return(yield s.render()).getChannelData(0)}))}class Ua extends ba{constructor(){super(Rr(Ua.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=Rr(Ua.getDefaults(),arguments,["frequency","type"]);wa(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new _a({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new _a({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),Qr(this,["frequency","detune"])}static getDefaults(){return Object.assign(ba.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class za extends La{constructor(){super(Rr(za.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=Rr(za.getDefaults(),arguments,["frequency","type"]);this.frequency=new Ca({context:this.context,units:"frequency",value:t.frequency}),Qr(this,"frequency"),this.detune=new Ca({context:this.context,units:"cents",value:t.detune}),Qr(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(La.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new Ua({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return za._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}))}{const t=za._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(gr(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),s=this.context.createPeriodicWave(e,n);this._wave=s,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),za._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),za._periodicWaveCache.length>100&&za._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){hr(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const s=new Float32Array(n),i=new Float32Array(n);let o=1;if("custom"===t){if(o=this._partials.length+1,this._partialCount=this._partials.length,n=o,0===this._partials.length)return[s,i]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(o=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],o=Math.max(o,2),n=o):this._partialCount=0,this._partials=[]}for(let r=1;r<n;++r){const n=2/(r*Math.PI);let a;switch(t){case"sine":a=r<=o?1:0,this._partials[r-1]=a;break;case"square":a=1&r?2*n:0,this._partials[r-1]=a;break;case"sawtooth":a=n*(1&r?1:-1),this._partials[r-1]=a;break;case"triangle":a=1&r?n*n*2*(r-1>>1&1?-1:1):0,this._partials[r-1]=a;break;case"custom":a=this._partials[r-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(s[r]=-a*Math.sin(e*r),i[r]=a*Math.cos(e*r)):(s[r]=0,i[r]=0)}return[s,i]}_inverseFFT(t,e,n){let s=0;const i=t.length;for(let o=0;o<i;o++)s+=t[o]*Math.cos(o*n)+e[o]*Math.sin(o*n);return s}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const s=2*Math.PI;for(let i=0;i<32;i++)n=Math.max(this._inverseFFT(t,e,i/32*s),n);return i=-this._inverseFFT(t,e,this._phase)/n,o=-1,r=1,Math.max(Math.min(i,r),o);var i,o,r}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return Ar(this,void 0,void 0,(function*(){return Ba(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}za._periodicWaveCache=[];class Ga extends va{constructor(){super(Object.assign(Rr(Ga.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return Aa(this,t,e,n),this}}class Xa extends Ga{constructor(){super(Object.assign(Rr(Xa.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=Rr(Xa.getDefaults(),arguments,["mapping","length"]);yr(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Ca.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let s=0,i=e;s<i;s++){const e=s/(i-1)*2-1;n[s]=t(e,s)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){ur(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Ya extends Ga{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Xa({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Za extends Ca{constructor(){super(Object.assign(Rr(Za.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=Rr(Za.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new xa({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ca.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Ha extends La{constructor(){super(Rr(Ha.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new Ya({context:this.context}),this._modulationNode=new xa({context:this.context});const t=Rr(Ha.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new za({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new za({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Za({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Qr(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(za.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Ar(this,void 0,void 0,(function*(){return Ba(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class Qa extends La{constructor(){super(Rr(Qa.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new xa({context:this.context,gain:0});const t=Rr(Qa.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new za({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Ca({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new za({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Za({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new Za({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Qr(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(za.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Ar(this,void 0,void 0,(function*(){return Ba(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Ka extends La{constructor(){super(Rr(Ka.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new xa({context:this.context,gain:0}),this._thresh=new Xa({context:this.context,mapping:t=>t<=0?-1:1});const t=Rr(Ka.getDefaults(),arguments,["frequency","width"]);this.width=new Ca({context:this.context,units:"audioRange",value:t.width}),this._triangle=new za({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Qr(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(La.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return Ar(this,void 0,void 0,(function*(){return Ba(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Ja extends La{constructor(){super(Rr(Ja.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=Rr(Ja.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Ca({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Ca({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,Qr(this,["frequency","detune"])}static getDefaults(){return Object.assign(za.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,s)=>t.detune.value=e+n*s))}}get count(){return this._oscillators.length}set count(t){if(hr(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new za({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):Jr});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return Ar(this,void 0,void 0,(function*(){return Ba(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class tc extends La{constructor(){super(Rr(tc.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Za({context:this.context,value:2});const t=Rr(tc.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Ka({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new za({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Qr(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(La.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return Ar(this,void 0,void 0,(function*(){return Ba(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const ec={am:Ha,fat:Ja,fm:Qa,oscillator:za,pulse:Ka,pwm:tc};class nc extends La{constructor(){super(Rr(nc.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=Rr(nc.getDefaults(),arguments,["frequency","type"]);this.frequency=new Ca({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Ca({context:this.context,units:"cents",value:t.detune}),Qr(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(za.getDefaults(),Qa.getDefaults(),Ha.getDefaults(),Ja.getDefaults(),Ka.getDefaults(),tc.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=ec[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof ec[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&_r(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&_r(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&wr(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return Ar(this,void 0,void 0,(function*(){return Ba(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function sc(t,e=1/0){const n=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){hr(s,t,e),n.set(this,s)}})}}function ic(t,e=1/0){const n=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){hr(this.toSeconds(s),t,e),n.set(this,s)}})}}class oc extends La{constructor(){super(Rr(oc.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=Rr(oc.getDefaults(),arguments,["url","onload"]);this._buffer=new ta({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(La.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Jr,onerror:Jr,playbackRate:1,reverse:!1})}load(t){return Ar(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=Jr){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?Pr(e,this._loopStart):Pr(e,0);const s=this.toSeconds(e),i=n;n=Pr(n,Math.max(this._buffer.duration-s,0));let o=this.toSeconds(n);o/=this._playbackRate,t=this.toSeconds(t);const r=new Wa({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(r),this._loop&&mr(i)?r.start(t,s):r.start(t,s,o-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&hr(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&hr(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}Cr([ic(0)],oc.prototype,"fadeIn",void 0),Cr([ic(0)],oc.prototype,"fadeOut",void 0);class rc extends va{constructor(){super(Rr(rc.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Ca({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=Rr(rc.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(va.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(wr(t))return t;{let n;for(n in ac)if(ac[n][e]===t)return n;return t}}_setCurve(t,e,n){if(wr(n)&&Reflect.has(ac,n)){const s=ac[n];vr(s)?"_decayCurve"!==t&&(this[t]=s[e]):this[t]=s}else{if(!yr(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){ur(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),i=this.getValueAtTime(t);if(i>0){n=(1-i)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let s=this._attackCurve;for(let t=1;t<s.length;t++)if(s[t-1]<=i&&i<=s[t]){s=this._attackCurve.slice(t),s[0]=i;break}this._sig.setValueCurveAtTime(s,t,n,e)}if(s&&this.sustain<1){const i=e*this.sustain,o=t+n;this.log("decay",o),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(i,s+o):this._sig.exponentialApproachValueAtTime(i,o,s)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(ur(yr(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return Aa(this,t,e,n),this}asArray(t=1024){return Ar(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new ea(1,e,this.context.sampleRate),s=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=s+this.toSeconds(this.release),o=.1*i,r=i+o,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/r,decay:e*this.toSeconds(this.decay)/r,release:e*this.toSeconds(this.release)/r,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(s+o)/r,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}Cr([ic(0)],rc.prototype,"attack",void 0),Cr([ic(0)],rc.prototype,"decay",void 0),Cr([sc(0,1)],rc.prototype,"sustain",void 0),Cr([ic(0)],rc.prototype,"release",void 0);const ac=(()=>{const t=128;let e,n;const s=[];for(e=0;e<t;e++)s[e]=Math.sin(e/127*(Math.PI/2));const i=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;i[e]=t/10+.83*n}i[127]=1;const o=[];for(e=0;e<t;e++)o[e]=Math.ceil(e/127*5)/5;const r=[];for(e=0;e<t;e++)n=e/127,r[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,s=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(s*(1-n))}function c(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:c(a),Out:a},cosine:{In:s,Out:(l=s,l.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:i,Out:c(i)},sine:{In:r,Out:c(r)},step:{In:o,Out:c(o)}};var l})();class cc extends va{constructor(){super(Rr(cc.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=Rr(cc.getDefaults(),arguments);this._volume=this.output=new Pa({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Qr(this,"volume")}static getDefaults(){return Object.assign(va.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const s=t[e],i=this.context.transport.schedule((s=>{t[e]=s,n.apply(this,t)}),s);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,s){const i=this.toSeconds(n),o=this.toSeconds(e);return this.triggerAttack(t,i,s),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class lc extends cc{constructor(){super(Rr(lc.getDefaults(),arguments));const t=Rr(lc.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(cc.getDefaults(),{detune:0,onsilence:Jr,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const s=this.toSeconds(e);return this._triggerEnvelopeAttack(s,n),this.setNote(t,s),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),s=t instanceof ha?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(s,t,n)}else this.frequency.setValueAtTime(s,n);return this}}Cr([ic(0)],lc.prototype,"portamento",void 0);class uc extends rc{constructor(){super(Rr(uc.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new xa({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class hc extends lc{constructor(){super(Rr(hc.getDefaults(),arguments)),this.name="Synth";const t=Rr(hc.getDefaults(),arguments);this.oscillator=new nc(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new uc(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),Qr(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(lc.getDefaults(),{envelope:Object.assign(Vr(rc.getDefaults(),Object.keys(va.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Vr(nc.getDefaults(),[...Object.keys(La.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class dc extends hc{constructor(){super(Rr(dc.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=Rr(dc.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,Qr(this,["oscillator","envelope"])}static getDefaults(){return Nr(lc.getDefaults(),hc.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),s=this.toFrequency(t instanceof ha?t.toFrequency():t),i=s*this.octaves;return this.oscillator.frequency.setValueAtTime(i,n),this.oscillator.frequency.exponentialRampToValueAtTime(s,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Cr([sc(0)],dc.prototype,"octaves",void 0),Cr([ic(0)],dc.prototype,"pitchDecay",void 0);const pc=new Set;function fc(t){pc.add(t)}function mc(t,e){const n=`registerProcessor("${t}", ${e})`;pc.add(n)}fc('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');fc("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");fc("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");mc("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class gc extends cc{constructor(){super(Rr(gc.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=Rr(gc.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const s=parseInt(n,10);if(ur(xr(n)||_r(s)&&isFinite(s),`url key is neither a note or midi pitch: ${n}`),xr(n)){const s=new ha(this.context,n).toMidi();e[s]=t.urls[n]}else _r(s)&&isFinite(s)&&(e[s]=t.urls[s])})),this._buffers=new Ea({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(cc.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Jr,onerror:Jr,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const s=ca(new ha(this.context,t).toFrequency()),i=Math.round(s),o=s-i,r=this._findClosest(i),a=i-r,c=this._buffers.get(a),l=oa(r+o),u=new Wa({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:l}).connect(this.output);u.start(e,0,c.duration/l,n),yr(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(u),u.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){const t=this._activeSources.get(i),e=t.indexOf(u);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new ha(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,s=1){const i=this.toSeconds(n);return this.triggerAttack(t,i,s),yr(e)?(ur(yr(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const s=e[Math.min(n,e.length-1)];this.triggerRelease(t,i+this.toSeconds(s))}))):this.triggerRelease(t,i+this.toSeconds(e)),this}add(t,e,n){if(ur(xr(t)||isFinite(t),`note must be a pitch or midi: ${t}`),xr(t)){const s=new ha(this.context,t).toMidi();this._buffers.add(s,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}Cr([ic(0)],gc.prototype,"attack",void 0),Cr([ic(0)],gc.prototype,"release",void 0);class _c extends va{constructor(){super(Object.assign(Rr(_c.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=Rr(_c.getDefaults(),arguments,["pan"]);this.pan=new _a({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",Qr(this,"pan")}static getDefaults(){return Object.assign(va.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}mc("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class vc extends va{constructor(){super(Rr(vc.getDefaults(),arguments,["solo"])),this.name="Solo";const t=Rr(vc.getDefaults(),arguments,["solo"]);this.input=this.output=new xa({context:this.context}),vc._allSolos.has(this.context)||vc._allSolos.set(this.context,new Set),vc._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(va.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),vc._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){vc._soloed.has(this.context)||vc._soloed.set(this.context,new Set),vc._soloed.get(this.context).add(this)}_removeSolo(){vc._soloed.has(this.context)&&vc._soloed.get(this.context).delete(this)}_isSoloed(){return vc._soloed.has(this.context)&&vc._soloed.get(this.context).has(this)}_noSolos(){return!vc._soloed.has(this.context)||vc._soloed.has(this.context)&&0===vc._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),vc._allSolos.get(this.context).delete(this),this._removeSolo(),this}}vc._allSolos=new Map,vc._soloed=new Map;class yc extends va{constructor(){super(Rr(yc.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=Rr(yc.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new _c({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Pa({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,Qr(this,["pan","volume"])}static getDefaults(){return Object.assign(va.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class wc extends va{constructor(){super(Rr(wc.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=Rr(wc.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new vc({solo:t.solo,context:this.context}),this._panVol=this.output=new yc({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Qr(this,["pan","volume"])}static getDefaults(){return Object.assign(va.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return wc.buses.has(t)||wc.buses.set(t,new xa({context:this.context})),wc.buses.get(t)}send(t,e=0){const n=this._getBus(t),s=new xa({context:this.context,units:"decibels",gain:e});return this.connect(s),s.connect(n),s}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}wc.buses=new Map;class xc extends va{constructor(){super(...arguments),this.name="Listener",this.positionX=new _a({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new _a({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new _a({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new _a({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new _a({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new _a({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new _a({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new _a({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new _a({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(va.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}zr((t=>{t.listener=new xc({context:t})})),Xr((t=>{t.listener.dispose()}));const bc=ia().transport;ia().destination,ia().destination,ia().listener,ia().draw,ia();let Tc=!1;const Cc=yt(Tc),Ac=Cc;Cc.subscribe((t=>Tc=t)),bc.on("start",(()=>Cc.set(!0))),bc.on("stop",(()=>Cc.set(!1)));const Sc=yt(100);let kc=!0;const Oc=yt(kc);Oc.subscribe((t=>kc=t));let Mc=!1;const Ec=yt(Mc);Ec.subscribe((t=>{Mc=t,bc.loop=Mc,Mc||qc()}));const Dc=yt(void 0),Ic=wt([Ac,Dc,qe],(([t,e,n])=>{if(t&&e&&n&&!(e<n.start.sectionIdx||e>n.end.sectionIdx))return e})),Nc=function(t,e){return wt(t,((t,e)=>{null!=t&&e(t)}),e)}(bt(wt([Dc,re],(([t,e])=>{if(void 0!==t)return e[t]}))),void 0);let Rc,Pc;async function Vc(t,e){await async function(t){const e=t?"/assets/demo.mp3":"/assets/audio.mp3",n=new xa(1).toDestination();return Sc.subscribe((t=>n.gain.value=t/100)),new Promise((t=>{const s=new oc(e,(()=>{Rc=s.buffer.duration,t(s)})).sync().start(0).connect(n)}))}(e),bc.loop=!0,bc.loopEnd=Rc,Object.entries(t).forEach((([t,e])=>{const n=parseInt(t);bc.schedule((()=>Dc.set(n)),e.startTime),bc.schedule((()=>Dc.set(void 0)),e.endTime)}))}function $c(){if(void 0===jc)return;sa.resume();let t=se(jc.start.time,0,Rc),e=se(jc.end.time,0,Rc);t===e&&(t-=.2,e+=.2),bc.loop=!1,bc.loopStart=t,bc.loopEnd=e,"started"===bc.state?bc.seconds=t:bc.start(void 0,t),bc.loop=Mc,Dc.set(jc.start.sectionIdx),Mc||(Pc=e,bc.scheduleOnce((()=>{Pc===e&&(Mc||bc.stop())}),e))}function qc(){Tc&&bc.stop()}const Fc=yt(!1);let jc,Lc;async function Wc(t){var e,n;if(!t)return;const s=null===(e=he(t.anchor.section))||void 0===e?void 0:e.firstChild,i=null===(n=he(t.focus.section))||void 0===n?void 0:n.firstChild;if(!s||!i)return;const o=window.getSelection();o&&(o.setBaseAndExtent(s,t.anchor.offset+1,i,t.focus.offset+1),await ke())}async function Bc(t){const e=he(t);await async function(t){return zc(t,1)}(e)}async function Uc(t){const e=he(t);await Gc(e)}async function zc(t,e){if(void 0===t)return;const n=t.hasChildNodes()?t.firstChild:t;if(null===n)return;const s=document.createRange();s.setStart(n,e),s.setEnd(n,e);const i=window.getSelection();null!==i&&(i.removeAllRanges(),i.addRange(s),await ke())}async function Gc(t){var e,n;return zc(t,(null!==(n=null===(e=null==t?void 0:t.textContent)||void 0===e?void 0:e.length)&&void 0!==n?n:1)-1)}wt([Fc,qe],(([t,e])=>({suppress:t,timings:e}))).subscribe((({suppress:t,timings:e})=>{if(jc=e,!t)return void 0===e?qc():kc?$c():void qc()}));let Xc=0;const Yc=yt([]),Zc=Yc;function Hc(t){Yc.update((e=>(e.push({idx:Xc,text:t}),e))),Xc++,setTimeout((()=>{Yc.update((t=>(t.shift(),t)))}),2500)}function Qc(t){const e=t-1;return e*e*e+1}function Kc(t,{delay:e=0,duration:n=400,easing:s=Qc}={}){const i=getComputedStyle(t),o=+i.opacity,r=parseFloat(i.height),a=parseFloat(i.paddingTop),c=parseFloat(i.paddingBottom),l=parseFloat(i.marginTop),u=parseFloat(i.marginBottom),h=parseFloat(i.borderTopWidth),d=parseFloat(i.borderBottomWidth);return{delay:e,duration:n,easing:s,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*o};height: ${t*r}px;padding-top: ${t*a}px;padding-bottom: ${t*c}px;margin-top: ${t*l}px;margin-bottom: ${t*u}px;border-top-width: ${t*h}px;border-bottom-width: ${t*d}px;`}}function Jc(t){let e,n,s,i;return{c(){e=T("p"),n=C(t[0]),M(e,"class","svelte-vtwz7k")},m(t,s){w(t,e,s),y(e,n),i=!0},p(t,[e]){(!i||1&e)&&E(n,t[0])},i(t){i||(Z((()=>{s||(s=lt(e,Kc,{},!0)),s.run(1)})),i=!0)},o(t){s||(s=lt(e,Kc,{},!1)),s.run(0),i=!1},d(t){t&&x(e),t&&s&&s.end()}}}function tl(t,e,n){let{text:s}=e;return t.$$set=t=>{"text"in t&&n(0,s=t.text)},[s]}class el extends _t{constructor(t){super(),gt(this,t,tl,Jc,r,{text:0})}}function nl(t,e,n){const s=t.slice();return s[1]=e[n],s}function sl(t,e){let n,s,i;return s=new el({props:{text:e[1].text}}),{key:t,first:null,c(){n=S(),pt(s.$$.fragment),this.first=n},m(t,e){w(t,n,e),ft(s,t,e),i=!0},p(t,n){e=t;const i={};1&n&&(i.text=e[1].text),s.$set(i)},i(t){i||(rt(s.$$.fragment,t),i=!0)},o(t){at(s.$$.fragment,t),i=!1},d(t){t&&x(n),mt(s,t)}}}function il(t){let e,n,s=[],i=new Map,o=t[0];const r=t=>t[1].idx;for(let e=0;e<o.length;e+=1){let n=nl(t,o,e),a=r(n);i.set(a,s[e]=sl(a,n))}return{c(){e=T("div");for(let t=0;t<s.length;t+=1)s[t].c();M(e,"class","toastContainer svelte-27vz9k")},m(t,i){w(t,e,i);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){1&n&&(o=t[0],it(),s=function(t,e,n,s,i,o,r,a,c,l,u,h){let d=t.length,p=o.length,f=d;const m={};for(;f--;)m[t[f].key]=f;const g=[],_=new Map,v=new Map;for(f=p;f--;){const t=h(i,o,f),a=n(t);let c=r.get(a);c?s&&c.p(t,e):(c=l(a,t),c.c()),_.set(a,g[f]=c),a in m&&v.set(a,Math.abs(f-m[a]))}const y=new Set,w=new Set;function x(t){rt(t,1),t.m(a,u),r.set(t.key,t),u=t.first,p--}for(;d&&p;){const e=g[p-1],n=t[d-1],s=e.key,i=n.key;e===n?(u=e.first,d--,p--):_.has(i)?!r.has(s)||y.has(s)?x(e):w.has(i)?d--:v.get(s)>v.get(i)?(w.add(s),x(e)):(y.add(i),d--):(c(n,r),d--)}for(;d--;){const e=t[d];_.has(e.key)||c(e,r)}for(;p;)x(g[p-1]);return g}(s,n,r,1,t,o,i,e,dt,sl,null,nl),ot())},i(t){if(!n){for(let t=0;t<o.length;t+=1)rt(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)at(s[t]);n=!1},d(t){t&&x(e);for(let t=0;t<s.length;t+=1)s[t].d()}}}function ol(t,e,n){let s;return c(t,Zc,(t=>n(0,s=t))),[s]}class rl extends _t{constructor(t){super(),gt(this,t,ol,il,r,{})}}function al(e){let n;return{c(){n=T("div"),n.innerHTML='<img class="logo svelte-1yfmxcy" src="/assets/smallBrand.svg" alt="logo"/>',M(n,"class","header svelte-1yfmxcy"),I(n,"playing",e[0])},m(t,e){w(t,n,e)},p(t,[e]){1&e&&I(n,"playing",t[0])},i:t,o:t,d(t){t&&x(n)}}}function cl(t,e,n){let s;return c(t,Ac,(t=>n(0,s=t))),[s]}class ll extends _t{constructor(t){super(),gt(this,t,cl,al,r,{})}}function ul(e){let n,s,i,o,r,a=`${e[4]}`,c=e[2]?"":" ";return{c(){n=T("span"),s=C(a),o=A(),r=C(c),M(n,"class","section svelte-st209d"),M(n,"data-sectionidx",i=e[1].idx),I(n,"highlight",e[3]),I(n,"placeholder",!e[1].edited),I(n,"sectionPlaying",e[5]===e[1].idx),I(n,"enableTextSelection",e[6]),I(n,"underline",0===e[4].length)},m(t,e){w(t,n,e),y(n,s),w(t,o,e),w(t,r,e)},p(t,[e]){16&e&&a!==(a=`${t[4]}`)&&E(s,a),2&e&&i!==(i=t[1].idx)&&M(n,"data-sectionidx",i),8&e&&I(n,"highlight",t[3]),2&e&&I(n,"placeholder",!t[1].edited),34&e&&I(n,"sectionPlaying",t[5]===t[1].idx),64&e&&I(n,"enableTextSelection",t[6]),16&e&&I(n,"underline",0===t[4].length),4&e&&c!==(c=t[2]?"":" ")&&E(r,c)},i:t,o:t,d(t){t&&x(n),t&&x(o),t&&x(r)}}}function hl(e,n,s){let i,o,r,l,u,h=t,d=()=>(h(),h=a(g,(t=>s(1,i=t))),g);c(e,be,(t=>s(7,o=t))),c(e,Ce,(t=>s(8,r=t))),c(e,Ic,(t=>s(5,l=t))),c(e,Fc,(t=>s(6,u=t))),e.$$.on_destroy.push((()=>h()));let p,f,m,{sectionStore:g}=n;return d(),e.$$set=t=>{"sectionStore"in t&&d(s(0,g=t.sectionStore))},e.$$.update=()=>{2&e.$$.dirty&&s(2,p=i.endParagraph),386&e.$$.dirty&&s(3,f=(null!=o?o:0)<=i.idx&&(null!=r?r:0)>=i.idx),2&e.$$.dirty&&s(4,m=i.edited?i.text:i.placeholder)},[g,i,p,f,m,l,u,o,r]}class dl extends _t{constructor(t){super(),gt(this,t,hl,ul,r,{sectionStore:0})}}function pl(t,e,n){const s=t.slice();return s[6]=e[n],s}function fl(t){let e,n;return e=new dl({props:{sectionStore:oe(t[1],t[6])}}),{c(){pt(e.$$.fragment)},m(t,s){ft(e,t,s),n=!0},p(t,n){const s={};3&n&&(s.sectionStore=oe(t[1],t[6])),e.$set(s)},i(t){n||(rt(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){mt(e,t)}}}function ml(t){let e,n,s=t[0],i=[];for(let e=0;e<s.length;e+=1)i[e]=fl(pl(t,s,e));const o=t=>at(i[t],1,1,(()=>{i[t]=null}));return{c(){e=T("p");for(let t=0;t<i.length;t+=1)i[t].c();M(e,"class","paragraph svelte-1a2jg8s"),I(e,"nonePlaying",!t[2])},m(t,s){w(t,e,s);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,[n]){if(3&n){let r;for(s=t[0],r=0;r<s.length;r+=1){const o=pl(t,s,r);i[r]?(i[r].p(o,n),rt(i[r],1)):(i[r]=fl(o),i[r].c(),rt(i[r],1),i[r].m(e,null))}for(it(),r=s.length;r<i.length;r+=1)o(r);ot()}4&n&&I(e,"nonePlaying",!t[2])},i(t){if(!n){for(let t=0;t<s.length;t+=1)rt(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)at(i[t]);n=!1},d(t){t&&x(e),b(i,t)}}}function gl(t,e,n){let s,i;c(t,re,(t=>n(5,s=t))),c(t,Ac,(t=>n(2,i=t)));let o,r,{start:a}=e,{end:l}=e;return t.$$set=t=>{"start"in t&&n(3,a=t.start),"end"in t&&n(4,l=t.end)},t.$$.update=()=>{24&t.$$.dirty&&n(0,o=function(t,e){const n=[];for(let s=t;s<=e;s++)n.push(s);return n}(a,l)),32&t.$$.dirty&&n(1,r=s)},[o,r,i,a,l,s]}class _l extends _t{constructor(t){super(),gt(this,t,gl,ml,r,{start:3,end:4})}}function vl(t,e,n){const s=t.slice();return s[1]=e[n].start,s[2]=e[n].end,s}function yl(t){let e,n;return e=new _l({props:{start:t[1],end:t[2]}}),{c(){pt(e.$$.fragment)},m(t,s){ft(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.start=t[1]),1&n&&(s.end=t[2]),e.$set(s)},i(t){n||(rt(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){mt(e,t)}}}function wl(t){let e,n,s=t[0],i=[];for(let e=0;e<s.length;e+=1)i[e]=yl(vl(t,s,e));const o=t=>at(i[t],1,1,(()=>{i[t]=null}));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=S()},m(t,s){for(let e=0;e<i.length;e+=1)i[e].m(t,s);w(t,e,s),n=!0},p(t,[n]){if(1&n){let r;for(s=t[0],r=0;r<s.length;r+=1){const o=vl(t,s,r);i[r]?(i[r].p(o,n),rt(i[r],1)):(i[r]=yl(o),i[r].c(),rt(i[r],1),i[r].m(e.parentNode,e))}for(it(),r=s.length;r<i.length;r+=1)o(r);ot()}},i(t){if(!n){for(let t=0;t<s.length;t+=1)rt(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)at(i[t]);n=!1},d(t){b(i,t),t&&x(e)}}}function xl(t,e,n){let s;return c(t,ce,(t=>n(0,s=t))),[s]}class bl extends _t{constructor(t){super(),gt(this,t,xl,wl,r,{})}}let Tl;re.subscribe((t=>Tl=t));let Cl=0;const Al=[];let Sl,kl={};async function Ol(t,e,n){if(i=n,(s=e).idx===i.idx&&s.text===i.text&&s.startTime===i.startTime&&s.endTime===i.endTime&&s.edited===i.edited&&s.endParagraph===i.endParagraph)return;var s,i;const o=kl[t];void 0===o?kl[t]={from:e,to:n}:o.to=n}function Ml(){if(0===Object.keys(kl).length)return;console.log("Committed history",kl);const t=Al.length-Cl;Al.splice(t,Al.length),Al.push({selection:Sl,sections:kl}),kl={},Cl=0}pe.subscribe((t=>Sl=t)),xt(pe,void 0,((t,e)=>{var n,s,i,o;return(null===(n=null==t?void 0:t.anchor)||void 0===n?void 0:n.section)!==(null===(s=null==e?void 0:e.anchor)||void 0===s?void 0:s.section)||(null===(i=null==t?void 0:t.focus)||void 0===i?void 0:i.section)!==(null===(o=null==e?void 0:e.focus)||void 0===o?void 0:o.section)})).subscribe((()=>Ml()));class El{constructor(t){this.underlying=t}get(){return this.underlying}setText(t){return this.update((e=>e.text===t&&e.edited?e:Object.assign(Object.assign({},e),{text:t,completionOptions:ne(t,e.originalOptions),edited:!0})))}toggleParagraph(){return this.update((t=>Object.assign(Object.assign({},t),{endParagraph:!t.endParagraph})))}enableEndParagraph(){return this.update((t=>Object.assign(Object.assign({},t),{endParagraph:!0})))}disableEndParagraph(){return this.update((t=>Object.assign(Object.assign({},t),{endParagraph:!1})))}applyPatch(t){return this.update((e=>{var n,s,i;return Object.assign(Object.assign({},e),{text:null!==(n=t.text)&&void 0!==n?n:e.text,edited:null!==(s=t.edited)&&void 0!==s?s:e.edited,endParagraph:null!==(i=t.endParagraph)&&void 0!==i?i:e.endParagraph})}))}}class Dl extends El{update(t){return this.underlying.update((e=>{const n=t(e);return Ol(e.idx,e,n),n})),this}static ofIdx(t){const e=Tl[t];if(e)return new Dl(e)}}class Il extends El{update(t){return this.underlying.update((e=>{if(void 0===e)return;const n=t(e);return Ol(e.idx,e,n),n})),this}}function Nl(t,e,n){const s=t.slice();return s[29]=e[n],s[31]=n,s}function Rl(t){let e,n,s,o,r=t[1],a=[];for(let e=0;e<r.length;e+=1)a[e]=Pl(Nl(t,r,e));return{c(){e=T("div");for(let t=0;t<a.length;t+=1)a[t].c();M(e,"class","popup svelte-1r3emyk"),M(e,"style",n=`left: ${t[4]}px; top: ${t[5]}px;`),I(e,"transparent",t[2])},m(n,i){w(n,e,i);for(let t=0;t<a.length;t+=1)a[t].m(e,null);s||(o=[k(e,"mouseenter",t[11]),k(e,"mouseleave",t[12])],s=!0)},p(t,s){if(1602&s[0]){let n;for(r=t[1],n=0;n<r.length;n+=1){const i=Nl(t,r,n);a[n]?a[n].p(i,s):(a[n]=Pl(i),a[n].c(),a[n].m(e,null))}for(;n<a.length;n+=1)a[n].d(1);a.length=r.length}48&s[0]&&n!==(n=`left: ${t[4]}px; top: ${t[5]}px;`)&&M(e,"style",n),4&s[0]&&I(e,"transparent",t[2])},d(t){t&&x(e),b(a,t),s=!1,i(o)}}}function Pl(t){let e,n,s,o,r,a=t[29]+"";function c(){return t[21](t[31])}function l(){return t[22](t[31])}return{c(){e=T("span"),n=C(a),s=A(),M(e,"class","option svelte-1r3emyk"),I(e,"highlight",t[31]===t[6]),I(e,"topBorder",0!==t[31])},m(t,i){w(t,e,i),y(e,n),y(e,s),o||(r=[k(e,"mouseenter",c),k(e,"click",l)],o=!0)},p(s,i){t=s,2&i[0]&&a!==(a=t[29]+"")&&E(n,a),64&i[0]&&I(e,"highlight",t[31]===t[6])},d(t){t&&x(e),o=!1,i(r)}}}function Vl(e){let n,s,o,r,a,c,l,u=e[0]&&Rl(e);return{c(){n=A(),s=T("span"),s.textContent="Test",r=A(),u&&u.c(),a=S(),M(s,"class","option invisible svelte-1r3emyk"),Z((()=>e[20].call(s)))},m(t,i){w(t,n,i),w(t,s,i),o=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=T("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const s=D();let i;return s?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=k(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{i=k(n.contentWindow,"resize",e)}),y(t,n),()=>{(s||i&&n.contentWindow)&&i(),x(n)}}(s,e[20].bind(s)),w(t,r,i),u&&u.m(t,i),w(t,a,i),c||(l=[k(window,"resize",e[7]),k(document.body,"keydown",e[8])],c=!0)},p(t,e){t[0]?u?u.p(t,e):(u=Rl(t),u.c(),u.m(a.parentNode,a)):u&&(u.d(1),u=null)},i:t,o:t,d(t){t&&x(n),t&&x(s),o(),t&&x(r),u&&u.d(t),t&&x(a),c=!1,i(l)}}}function $l(t,e,n){let s,i,o;c(t,ye,(t=>n(17,s=t))),c(t,Ae,(t=>n(18,i=t))),c(t,Ac,(t=>n(19,o=t)));var r=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function r(t){try{c(s.next(t))}catch(t){o(t)}}function a(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((s=s.apply(t,e||[])).next())}))};let a,l,u,h,d,p,{wrapper:f}=e;function m(...t){var e;if(!a)return;const s=null===(e=he(null==a?void 0:a.idx))||void 0===e?void 0:e.getBoundingClientRect(),i=null==f?void 0:f.getBoundingClientRect();if(!i||!s)return;n(4,h=s.left-i.left);const o=a.completionOptions.length*(u+1)+5,r=s.top+s.height-i.top;r+o>=i.height?n(5,d=s.top-i.top-o):n(5,d=r)}let g,_=0;function v(...t){n(15,_=0)}function y(t){n(15,_=t)}function w(t){y(t),x()}function x(){return r(this,void 0,void 0,(function*(){if(l&&p.length>0&&void 0!==g){const t=oe(p,g);new Il(ye).setText(t)}yield async function(t){if(void 0!==t)return Bc(t+1)}(null==a?void 0:a.idx)}))}let b,T=!1;let C=!1;function A(){void 0!==b&&clearTimeout(b),n(2,C=!1)}return t.$$set=t=>{"wrapper"in t&&n(13,f=t.wrapper)},t.$$.update=()=>{var e,r;131072&t.$$.dirty[0]&&n(14,a=s),16384&t.$$.dirty[0]&&n(1,p=function(t){if(!t)return[];const{completionOptions:e,text:n,edited:s}=t;let i=e;return!s&&n.length>0&&(i=i.filter((t=>t!==n)),i.unshift(n)),i}(a)),278530&t.$$.dirty[0]&&n(0,l=!i&&void 0!==a&&p.length>0),16384&t.$$.dirty[0]&&m(),32770&t.$$.dirty[0]&&n(6,(e=_,r=p.length,g=(e%r+r)%r)),16385&t.$$.dirty[0]&&v(),589828&t.$$.dirty[0]&&(!o||C||T||(b=setTimeout((()=>{n(2,C=!0)}),1500))),524288&t.$$.dirty[0]&&(o||A())},[l,p,C,u,h,d,g,m,function(t){A(),"ArrowUp"!==t.key||t.ctrlKey||t.altKey?"ArrowDown"!==t.key||t.ctrlKey||t.altKey?"Enter"!==t.key||t.ctrlKey||(t.preventDefault(),x()):(t.preventDefault(),l&&n(15,_=(null!=_?_:-1)+1)):(t.preventDefault(),l&&n(15,_=(null!=_?_:0)-1))},y,w,function(){n(16,T=!0),A()},function(){n(16,T=!1),v()},f,a,_,T,s,i,o,function(){u=this.clientHeight,n(3,u)},t=>y(t),t=>w(t)]}class ql extends _t{constructor(t){super(),gt(this,t,$l,Vl,r,{wrapper:13},[-1,-1])}}var Fl=We((function(t,e){!function(){function e(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function n(t,e,n){var s=new XMLHttpRequest;s.open("GET",t),s.responseType="blob",s.onload=function(){a(s.response,e,n)},s.onerror=function(){console.error("could not download file")},s.send()}function s(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof Le&&Le.global===Le?Le:void 0,r=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(t,e,r){var a=o.URL||o.webkitURL,c=document.createElement("a");e=e||t.name||"download",c.download=e,c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?i(c):s(c.href)?n(t,e,r):i(c,c.target="_blank")):(c.href=a.createObjectURL(t),setTimeout((function(){a.revokeObjectURL(c.href)}),4e4),setTimeout((function(){i(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,o,r){if(o=o||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,r),o);else if(s(t))n(t,o,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){i(a)}))}}:function(t,e,s,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return n(t,e,s);var a="application/octet-stream"===t.type,c=/constructor/i.test(o.HTMLElement)||o.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&c||r)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},u.readAsDataURL(t)}else{var h=o.URL||o.webkitURL,d=h.createObjectURL(t);i?i.location=d:location.href=d,i=null,setTimeout((function(){h.revokeObjectURL(d)}),4e4)}});o.saveAs=a.saveAs=a,t.exports=a}()}));let jl,Ll,Wl={};function Bl(){const t=Object.keys(Wl).map((t=>parseInt(t)));t.sort(((t,e)=>t-e));const e=function(t){let e,n="";const s=[];for(const i of t)void 0===e&&(e=i.startTime),n+=" ",n+=i.edited?i.text:i.placeholder,i.endParagraph&&(s.push({startTime:e,endTime:i.endTime,text:n.trim()}),e=void 0,n="");return s.map(Ul).reduce(((t,e)=>t+e+"\n\n"),"").trim()}(t.map((t=>Wl[t])).filter((t=>void 0!==t))),n=new Blob([e],{type:"text/plain;charset=utf-8"});Fl.saveAs(n,"lexoralExport.srt")}function Ul({startTime:t,endTime:e,text:n},s){return`\n${s+1}\n${zl(t)} --\x3e ${zl(e)}\n${n}\n  `.trim()}function zl(t){const e=Math.floor(t/3600),n=Math.floor((t-3600*e)/60),s=Math.floor(t%60),i=Math.floor(t%1*1e3);return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")},${i.toString().padStart(2,"0")}`}Tt(re).subscribe((t=>Wl=t)),we.subscribe((t=>jl=t)),ve.subscribe((t=>Ll=t));let Gl=!1;async function Xl(t){if(Gl)return t.preventDefault(),void t.stopPropagation();Gl=!0,await async function(t){var e,n;if(t.altKey)return;const s=window.getSelection();if("Enter"===t.key&&t.ctrlKey&&(t.preventDefault(),void 0!==jl))return 1===(null==s?void 0:s.focusOffset)?null===(e=Dl.ofIdx(jl-1))||void 0===e||e.enableEndParagraph():null===(n=Dl.ofIdx(jl))||void 0===n||n.enableEndParagraph(),await Y(),await Bc(jl),void Ml();if("z"===t.key&&t.ctrlKey&&!t.shiftKey)return t.preventDefault(),await async function(){var t;Ml();const e=Al.length-1-Cl,n=Al[e];if(!n)return;Cl++,Object.entries(n.sections).forEach((([t,{from:e}])=>{const n=parseInt(t);oe(Tl,n).set(e)})),await Y();const s=Al[e-1];if(void 0===s){const e=null===(t=Object.keys(n.sections))||void 0===t?void 0:t[0];void 0!==e&&await Bc(parseInt(e))}else await Wc(null==s?void 0:s.selection)}(),await ke();if("y"===t.key&&t.ctrlKey)return t.preventDefault(),await async function(){Ml();const t=Al.length-Cl,e=Al[t];e&&(Cl--,Object.entries(e.sections).forEach((([t,{to:e}])=>{const n=parseInt(t);oe(Tl,n).set(e)})),await Y(),await Wc(null==e?void 0:e.selection))}(),await ke();if("s"===t.key&&t.ctrlKey)return t.preventDefault(),void Bl();if("ArrowLeft"===t.key)return t.ctrlKey?Zl(t,nu):Zl(t,Kl);if("ArrowRight"===t.key)return t.ctrlKey?Zl(t,su):Zl(t,Jl);if("Tab"===t.key&&!t.shiftKey)return Zl(t,eu);if("Tab"===t.key&&t.shiftKey){t.preventDefault();return Hl(!1,Ql(tu))}if("ArrowUp"===t.key)return Yl();if("ArrowDown"===t.key)return Yl();if("Home"===t.key)return t.ctrlKey?Zl(t,ru):Zl(t,iu);if("End"===t.key)return t.ctrlKey?Zl(t,au):Zl(t,ou);if("Backspace"===t.key)return async function(t){const e=window.getSelection();if(null===e)return;return e.isCollapsed?t.ctrlKey&&e.focusOffset<=1?async function(t,e){if(t.preventDefault(),!jl)return;const n=Dl.ofIdx(jl-1);if(!n)return;n.setText(""),cu(jl-1)&&(Ml(),n.disableEndParagraph(),await Y());return Bc(jl-1)}(t):e.focusOffset<=1?async function(t,e){var n;if(t.preventDefault(),!jl)return;cu(jl-1)&&(Ml(),null===(n=Dl.ofIdx(jl-1))||void 0===n||n.disableEndParagraph(),await Y());return Uc(jl-1)}(t):Yl():async function(t,e){var n;if(e.anchorNode===e.focusNode)return Yl();if(t.preventDefault(),void 0===Ll||void 0===jl)throw new Error("idxs are undefined when deleting");const s=Math.min(Ll,jl),i=Math.max(Ll,jl);for(let t=s;t<=i;t++)null===(n=Dl.ofIdx(t))||void 0===n||n.setText("");return Bc(s)}(t,e)}(t);if("Delete"===t.key)return async function(t){var e,n,s;const i=window.getSelection();if(null===i)return;if(!i.isCollapsed)return async function(t,e){var n;if(e.anchorNode===e.focusNode)return Yl();if(t.preventDefault(),void 0===Ll||void 0===jl)throw new Error("idxs are undefined when deleting");const s=Math.min(Ll,jl),i=Math.max(Ll,jl);for(let t=s;t<=i;t++)null===(n=Dl.ofIdx(t))||void 0===n||n.setText("");return Uc(i)}(t,i);const o=null!==(s=null===(n=null===(e=i.focusNode)||void 0===e?void 0:e.textContent)||void 0===n?void 0:n.length)&&void 0!==s?s:0,r=i.focusOffset>=o-1;return t.ctrlKey&&r?async function(t,e){var n,s;if(t.preventDefault(),!jl)return;cu(jl)&&(Ml(),null===(n=Dl.ofIdx(jl))||void 0===n||n.disableEndParagraph(),await Y());return null===(s=Dl.ofIdx(jl+1))||void 0===s||s.setText(""),Bc(jl+1)}(t):r?async function(t,e){var n;if(t.preventDefault(),!jl)return;cu(jl)&&(Ml(),null===(n=Dl.ofIdx(jl))||void 0===n||n.disableEndParagraph(),await Y());return Bc(jl+1)}(t):Yl()}(t);!1===(null==s?void 0:s.isCollapsed)&&t.preventDefault()}(t),Gl=!1}async function Yl(){await ke()}async function Zl(t,e){const n=Ql(e);return t.preventDefault(),Hl(t.shiftKey,n)}async function Hl(t,e){const n=t?function(){const t=window.getSelection();if(null===t)return;const e=t.anchorNode;if(null===e)return;return{node:e,offset:t.anchorOffset}}():e;if(!e)return;if(!n)return;const s=window.getSelection();s&&(s.setBaseAndExtent(n.node,n.offset,e.node,e.offset),await ke())}function Ql(t){if(void 0===jl)return;const e=window.getSelection();if(null===e)return;const{focusNode:n,focusOffset:s}=e;return null!==n?t(n,s,jl):void 0}function Kl(t,e,n){var s,i,o;if(e<=1){const t=null===(s=he(n-1))||void 0===s?void 0:s.firstChild;if(!t)return;return{node:t,offset:(null!==(o=null===(i=null==t?void 0:t.textContent)||void 0===i?void 0:i.length)&&void 0!==o?o:1)-1}}return{node:t,offset:e-1}}function Jl(t,e,n){var s,i,o;if(e>=(null!==(i=null===(s=null==t?void 0:t.textContent)||void 0===s?void 0:s.length)&&void 0!==i?i:0)-1){const t=null===(o=he(n+1))||void 0===o?void 0:o.firstChild;if(!t)return;return{node:t,offset:1}}return{node:t,offset:e+1}}function tu(t,e,n){var s,i,o;const r=null===(s=he(n-1))||void 0===s?void 0:s.firstChild;if(!r)return;return{node:r,offset:(null!==(o=null===(i=null==r?void 0:r.textContent)||void 0===i?void 0:i.length)&&void 0!==o?o:1)-1}}function eu(t,e,n){var s;const i=null===(s=he(n+1))||void 0===s?void 0:s.firstChild;if(i)return{node:i,offset:1}}function nu(t,e,n){var s;if(e<=1){const t=null===(s=he(n-1))||void 0===s?void 0:s.firstChild;if(!t)return;return{node:t,offset:1}}return{node:t,offset:1}}function su(t,e,n){var s,i,o,r,a,c,l;if(e>=(null!==(i=null===(s=null==t?void 0:t.textContent)||void 0===s?void 0:s.length)&&void 0!==i?i:0)-1){const t=null===(o=he(n+1))||void 0===o?void 0:o.firstChild;if(!t)return;return{node:t,offset:(null!==(a=null===(r=null==t?void 0:t.textContent)||void 0===r?void 0:r.length)&&void 0!==a?a:1)-1}}return{node:t,offset:(null!==(l=null===(c=null==t?void 0:t.textContent)||void 0===c?void 0:c.length)&&void 0!==l?l:1)-1}}function iu(t,e,n){const s=null==t?void 0:t.parentElement,i=null==s?void 0:s.parentElement,o=null==i?void 0:i.firstElementChild,r=null==o?void 0:o.firstChild;if(r)return{node:r,offset:1}}function ou(t,e,n){var s,i;const o=null==t?void 0:t.parentElement,r=null==o?void 0:o.parentElement,a=null==r?void 0:r.lastElementChild,c=null==a?void 0:a.firstChild;if(!c)return;return{node:c,offset:(null!==(i=null===(s=null==c?void 0:c.textContent)||void 0===s?void 0:s.length)&&void 0!==i?i:1)-1}}function ru(t,e,n){const s=null==t?void 0:t.parentElement,i=null==s?void 0:s.parentElement,o=null==i?void 0:i.parentElement,r=null==o?void 0:o.firstElementChild,a=null==r?void 0:r.firstElementChild,c=null==a?void 0:a.firstChild;if(c)return{node:c,offset:1}}function au(t,e,n){var s,i;const o=null==t?void 0:t.parentElement,r=null==o?void 0:o.parentElement,a=null==r?void 0:r.parentElement,c=null==a?void 0:a.lastElementChild,l=null==c?void 0:c.lastElementChild,u=null==l?void 0:l.firstChild;if(!u)return;return{node:u,offset:(null!==(i=null===(s=null==u?void 0:u.textContent)||void 0===s?void 0:s.length)&&void 0!==i?i:1)-1}}function cu(t){const e=he(t);if(!e)return!1;const n=he(t+1);return!!n&&e.parentElement!==n.parentElement}function lu(t){let e,n,s,o;const r=t[4].default,a=function(t,e,n,s){if(t){const i=l(t,e,n,s);return t[0](i)}}(r,t,t[3],null);return{c(){e=T("div"),a&&a.c(),M(e,"contenteditable",""),M(e,"tabindex",-1),M(e,"class","svelte-zxfupw")},m(i,r){w(i,e,r),a&&a.m(e,null),n=!0,s||(o=[k(e,"keydown",Xl),k(e,"mousedown",t[0]),k(e,"mouseup",t[1]),k(e,"input",t[2]),k(e,"dragover",O(t[5])),k(e,"drop",O(t[6])),k(e,"drag",O(t[7])),k(e,"dragstart",O(t[8])),k(e,"cut",O(t[9])),k(e,"paste",O(t[10]))],s=!0)},p(t,[e]){a&&a.p&&(!n||8&e)&&u(a,r,t,t[3],n?e:-1,null,null)},i(t){n||(rt(a,t),n=!0)},o(t){at(a,t),n=!1},d(t){t&&x(e),a&&a.d(t),s=!1,i(o)}}}function uu(t,e,n){let s;c(t,we,(t=>n(11,s=t)));let{$$slots:i={},$$scope:o}=e;var r=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function r(t){try{c(s.next(t))}catch(t){o(t)}}function a(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((s=s.apply(t,e||[])).next())}))};return t.$$set=t=>{"$$scope"in t&&n(3,o=t.$$scope)},[function(t){return r(this,void 0,void 0,(function*(){Fc.set(!0)}))},function(t){return r(this,void 0,void 0,(function*(){yield ke(),Fc.set(!1)}))},function(t){return r(this,void 0,void 0,(function*(){yield function(){var t,e;return r(this,void 0,void 0,(function*(){const n=null!==(e=null===(t=he(s))||void 0===t?void 0:t.textContent)&&void 0!==e?e:void 0;if(void 0===n)return;const i=n.slice(1,n.length-1);!function(){const t=window.getSelection();if(!t)return;const{anchorNode:e,anchorOffset:n,focusNode:s,focusOffset:i}=t;null!==e&&null!==s&&(Lc={anchorNode:e,anchorOffset:n,focusNode:s,focusOffset:i})}(),new Il(ye).setText(i),function(){var t;Lc&&(null===(t=window.getSelection())||void 0===t||t.setBaseAndExtent(Lc.anchorNode,Lc.anchorOffset,Lc.focusNode,Lc.focusOffset),Lc=void 0)}()}))}(),yield ke()}))},o,i,function(e){j.call(this,t,e)},function(e){j.call(this,t,e)},function(e){j.call(this,t,e)},function(e){j.call(this,t,e)},function(e){j.call(this,t,e)},function(e){j.call(this,t,e)}]}class hu extends _t{constructor(t){super(),gt(this,t,uu,lu,r,{})}}let du={};Tt(re).subscribe((t=>du=t));const pu=yt(void 0);let fu;pu.subscribe((t=>{void 0!==fu&&clearInterval(fu),void 0!==t&&(fu=setInterval((()=>{!function(){const t=Object.values(du).map((t=>{if(!t)return;const e={idx:t.idx};return t.text.length&&(e.text=t.text),t.edited&&(e.edited=t.edited),t.endParagraph&&(e.endParagraph=t.endParagraph),t.text.length||t.edited||t.endParagraph?e:void 0})).filter((t=>void 0!==t));localStorage.setItem("save",JSON.stringify(t)),Hc("Saved")}()}),1e3*t))}));const{document:mu}=ht;function gu(t){let e,n;return e=new ll({}),{c(){pt(e.$$.fragment)},m(t,s){ft(e,t,s),n=!0},i(t){n||(rt(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){mt(e,t)}}}function _u(t){let e,n;return e=new bl({}),{c(){pt(e.$$.fragment)},m(t,s){ft(e,t,s),n=!0},i(t){n||(rt(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){mt(e,t)}}}function vu(t){let e,n,s,o,r,a,c,l,u,h,d,p;n=new rl({});let f=!t[0]&&gu();return c=new ql({props:{wrapper:t[1]}}),u=new hu({props:{$$slots:{default:[_u]},$$scope:{ctx:t}}}),{c(){e=A(),pt(n.$$.fragment),s=A(),o=T("div"),f&&f.c(),r=A(),a=T("div"),pt(c.$$.fragment),l=A(),pt(u.$$.fragment),M(a,"class","wrapper svelte-8p26kg"),M(o,"class","container svelte-8p26kg")},m(i,m){w(i,e,m),ft(n,i,m),w(i,s,m),w(i,o,m),f&&f.m(o,null),y(o,r),y(o,a),ft(c,a,null),y(a,l),ft(u,a,null),t[4](a),h=!0,d||(p=[k(mu.body,"keydown",t[3]),k(mu.body,"keyup",t[2])],d=!0)},p(t,[e]){t[0]?f&&(it(),at(f,1,1,(()=>{f=null})),ot()):f?1&e&&rt(f,1):(f=gu(),f.c(),rt(f,1),f.m(o,r));const n={};2&e&&(n.wrapper=t[1]),c.$set(n);const s={};524288&e&&(s.$$scope={dirty:e,ctx:t}),u.$set(s)},i(t){h||(rt(n.$$.fragment,t),rt(f),rt(c.$$.fragment,t),rt(u.$$.fragment,t),h=!0)},o(t){at(n.$$.fragment,t),at(f),at(c.$$.fragment,t),at(u.$$.fragment,t),h=!1},d(r){r&&x(e),mt(n,r),r&&x(s),r&&x(o),f&&f.d(),mt(c),mt(u),t[4](null),d=!1,i(p)}}}function yu(t,e,n){let s,i,o;c(t,Ac,(t=>n(6,s=t))),c(t,Nc,(t=>n(7,i=t))),c(t,Ee,(t=>n(8,o=t)));var r=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function r(t){try{c(s.next(t))}catch(t){o(t)}}function a(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((s=s.apply(t,e||[])).next())}))};let a,{demo:l}=e,u=!1;return t.$$set=t=>{"demo"in t&&n(0,l=t.demo)},t.$$.update=()=>{1&t.$$.dirty&&(l||(!function(){const t=localStorage.getItem("save");if(null===t)return;JSON.parse(t).forEach((t=>{var e;null===(e=Dl.ofIdx(t.idx))||void 0===e||e.applyPatch(t)})),console.log("Loaded")}(),pu.set(60),Al.splice(0,Al.length),kl={},Cl=0))},[l,a,function(t){"Alt"===t.key&&(t.preventDefault(),u&&(u=!1,s?qc():$c()))},function(t){return r(this,void 0,void 0,(function*(){if("Alt"===t.key&&(t.preventDefault(),u=!0),"Escape"===t.key&&s){const e=null==i?void 0:i.idx;if(void 0!==e){const n=he(e);n&&(t.preventDefault(),yield Gc(n),qc())}}if("Alt"!==t.key&&t.altKey)switch(t.preventDefault(),u=!1,t.key){case"c":return function(){if("context"===o)return;Ee.set("context"),Hc("Enabled audio mode: context")}();case"p":return function(){if("paragraph"===o)return;Ee.set("paragraph"),Hc("Enabled audio mode: paragraph")}();case"o":return function(){if("onward"===o)return;Ee.set("onward"),Hc("Enabled audio mode: onward")}();case"l":return void Ec.update((t=>(Hc(t?"Looping disabled":"Looping enabled"),!t)));case"a":return void Oc.update((t=>(Hc(t?"Auto-play disabled":"Auto-play enabled"),!t)));case"ArrowLeft":return void Me.update((t=>{if(t>0){const e=t-1;return Hc(`Set context amount: ${e}`),e}return t}));case"ArrowRight":return void Me.update((t=>{const e=t+1;return Hc(`Set context amount: ${e}`),e}));case"ArrowUp":return void Sc.update((t=>{const e=t+function(t){return t>=400?100:t>=150?25:t>=50?10:t>=10?5:1}(t);return t!==e&&Hc(`Set volume: ${Math.round(e)}%`),e}));case"ArrowDown":return void Sc.update((t=>{const e=t-function(t){return t<=1?0:t<=10?1:t<=50?5:t<=150?10:t<=400?25:100}(t);return t!==e&&Hc(`Set volume: ${Math.round(e)}%`),e}))}}))},function(t){W[t?"unshift":"push"]((()=>{a=t,n(1,a)}))}]}class wu extends _t{constructor(t){super(),gt(this,t,yu,vu,r,{demo:0})}}function xu(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function bu(t){let e,n;return e=new wu({props:{demo:t[0]}}),{c(){pt(e.$$.fragment)},m(t,s){ft(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.demo=t[0]),e.$set(s)},i(t){n||(rt(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){mt(e,t)}}}function Tu(e){let n;return{c(){n=T("span"),n.textContent="Fetching data...",M(n,"class","loading svelte-1vn8scg")},m(t,e){w(t,n,e)},p:t,i:t,o:t,d(t){t&&x(n)}}}function Cu(t){let e,n,s,i,o={ctx:t,current:null,token:null,hasCatch:!1,pending:Tu,then:bu,catch:xu,blocks:[,,,]};return ut(s=fetch(t[1]).then(Au).then(t[2]).then(t[3]),o),{c(){e=A(),n=S(),o.block.c()},m(t,s){w(t,e,s),w(t,n,s),o.block.m(t,o.anchor=s),o.mount=()=>n.parentNode,o.anchor=n,i=!0},p(e,[n]){t=e,o.ctx=t,3&n&&s!==(s=fetch(t[1]).then(Au).then(t[2]).then(t[3]))&&ut(s,o)||function(t,e,n){const s=e.slice(),{resolved:i}=t;t.current===t.then&&(s[t.value]=i),t.current===t.catch&&(s[t.error]=i),t.block.p(s,n)}(o,t,n)},i(t){i||(rt(o.block),i=!0)},o(t){for(let t=0;t<3;t+=1){at(o.blocks[t])}i=!1},d(t){t&&x(e),t&&x(n),o.block.d(t),o.token=null,o=null}}}const Au=t=>t.json();function Su(t,e,n){let s,{demo:i}=e;i&&Oc.set(!0);return t.$$set=t=>{"demo"in t&&n(0,i=t.demo)},t.$$.update=()=>{1&t.$$.dirty&&n(1,s=i?"/assets/demo.json":"/assets/data.json")},[i,s,t=>le(t),t=>Vc(t,i)]}return new class extends _t{constructor(t){super(),gt(this,t,Su,Cu,r,{demo:0})}}({target:document.body,props:{demo:!0}})}();
//# sourceMappingURL=bundle.js.map
